<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Centre for Research into Ecological and Environmental Modelling   University of St Andrews">
<meta name="dcterms.date" content="2024-03-22">

<title>Distance sampling workshop - Distance sampling survey design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="../site_libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "lk4dxekwqr");
</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Distance sampling workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Pr1/sampling.html"> 
<span class="menu-text">Sampling</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr2/detnfns.html"> 
<span class="menu-text">Detection functions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr3/criticism.html"> 
<span class="menu-text">Criticism</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr4/precision.html"> 
<span class="menu-text">Precision</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr5/points.html"> 
<span class="menu-text">Points</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Pr6/design.html" aria-current="page"> 
<span class="menu-text">Design</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr7/strata.html"> 
<span class="menu-text">Strata</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr8/covariates.html"> 
<span class="menu-text">Covariates</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr9/multipliers.html"> 
<span class="menu-text">Multipliers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../extras/extras.html"> 
<span class="menu-text">Extras</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Pr6/Pr6-instructions.html">Distance sampling survey design</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr6/design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survey design practical 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr6/Pr6-instructions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Distance sampling survey design</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr6/leaflet-demo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distance sampling survey design supplement</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr6/effort-and-power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Effort and power calculations for line transect surveys</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr6/Pr6-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distance sampling survey design <strong>solution</strong></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#systematic-parallel-line-aerial-survey-of-marine-mammals-in-st-andrews-bay" id="toc-systematic-parallel-line-aerial-survey-of-marine-mammals-in-st-andrews-bay" class="nav-link" data-scroll-target="#systematic-parallel-line-aerial-survey-of-marine-mammals-in-st-andrews-bay">Systematic parallel line aerial survey of marine mammals in St Andrews bay</a>
  <ul class="collapse">
  <li><a href="#study-region" id="toc-study-region" class="nav-link" data-scroll-target="#study-region">Study Region</a></li>
  <li><a href="#coverage" id="toc-coverage" class="nav-link" data-scroll-target="#coverage">Coverage</a></li>
  <li><a href="#systematic-parallel-design" id="toc-systematic-parallel-design" class="nav-link" data-scroll-target="#systematic-parallel-design">Systematic Parallel Design</a></li>
  <li><a href="#zigzag-design" id="toc-zigzag-design" class="nav-link" data-scroll-target="#zigzag-design">Zigzag Design</a></li>
  </ul></li>
  <li><a href="#point-transect-bird-survey-in-tentsmuir-forest" id="toc-point-transect-bird-survey-in-tentsmuir-forest" class="nav-link" data-scroll-target="#point-transect-bird-survey-in-tentsmuir-forest">Point Transect Bird Survey in Tentsmuir Forest</a>
  <ul class="collapse">
  <li><a href="#projecting-your-study-region" id="toc-projecting-your-study-region" class="nav-link" data-scroll-target="#projecting-your-study-region">Projecting your Study Region</a></li>
  <li><a href="#coverage-1" id="toc-coverage-1" class="nav-link" data-scroll-target="#coverage-1">Coverage</a></li>
  <li><a href="#design" id="toc-design" class="nav-link" data-scroll-target="#design">Design</a></li>
  <li><a href="#generate-a-survey" id="toc-generate-a-survey" class="nav-link" data-scroll-target="#generate-a-survey">Generate a Survey</a>
  <ul class="collapse">
  <li><a href="#save-coordinates-to-a-file" id="toc-save-coordinates-to-a-file" class="nav-link" data-scroll-target="#save-coordinates-to-a-file">Save coordinates to a file</a></li>
  </ul></li>
  <li><a href="#assessing-coverage-and-design-statistics" id="toc-assessing-coverage-and-design-statistics" class="nav-link" data-scroll-target="#assessing-coverage-and-design-statistics">Assessing Coverage and Design Statistics</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Distance sampling survey design</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Centre for Research into Ecological and Environmental Modelling <br> <strong>University of St Andrews</strong> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>We provide two exercises in survey design so you can choose the one you feel is most useful to you.</p>
<ul>
<li>The first example involves designing a line transect survey to estimate the abundance of porpoise, common dolphins and seals in and around St Andrews Bay.
<ul>
<li>It considers how you choose your design based on effort limitations.</li>
<li>It also compares an aerial survey based on systematic parallel lines with a boat based survey using zigzags.</li>
</ul></li>
<li>The <a href="#point-transect-bird-survey-in-tentsmuir-forest">second example</a> involves designing a point transect bird survey in Tentsmuir Forest.
<ul>
<li>This looks at how to project your study area from latitude and longitude on to a flat plane using R.</li>
<li>It also involves defining a design for multiple strata with different coverage in each strata.</li>
</ul></li>
</ul>
</section>
<section id="systematic-parallel-line-aerial-survey-of-marine-mammals-in-st-andrews-bay" class="level1">
<h1>Systematic parallel line aerial survey of marine mammals in St Andrews bay</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise objective
</div>
</div>
<div class="callout-body-container callout-body">
<p>Decide on a systematic line spacing which uses as much of the 250km of available effort as possible without risking not being able to complete the survey. We must remember that some of the 250km will be spent travelling off-effort between transects.</p>
</div>
</div>
<p>This project involves designing an aerial survey of porpoise, common dolphins and seals in and around St Andrews Bay. (For those who know the area: the nearer St Andrews bay region has been extended in an easterly direction out past Bell Rock, as there are some pockets of deeper water that are of interest with regard to the distribution of cetaceans. The survey region has a chunk missing due to a no-fly zone around Buddon Ness, just south of Carnoustie because of the Royal Marines base there).</p>
<p>This uses the package <code>leaflet</code> to give you a better image of the portion of the North Sea where the aerial survey for marine mammals was proposed, here is a quick figure, showing the Kingdom of Fife extending eastward from the coast of Scotland into the North Sea.</p>
<div class="cell">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-5cce429bff5500c38103" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5cce429bff5500c38103">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.NatGeoWorldMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolygons","args":[[[[{"lng":[-2.814865192775538,-2.816743098392833,-2.814723014831543,-2.814723014831543,-2.813055038452148,-2.813055038452148,-2.810832977294922,-2.810832977294922,-2.810278892517033,-2.810278892517033,-2.809166908264103,-2.809166908264103,-2.806387901306039,-2.806387901306039,-2.805278062820378,-2.805278062820378,-2.80361008644104,-2.80361008644104,-2.803056001663094,-2.803056001663094,-2.799165964126473,-2.799165964126473,-2.79694390296936,-2.79694390296936,-2.793055057525635,-2.793055057525635,-2.79249906539917,-2.79249906539917,-2.790277004241943,-2.790277004241943,-2.78870034371198,-2.781350248646425,-2.711518949701343,-2.712472334062888,-2.711945056915283,-2.711945056915283,-2.711389064788818,-2.711389064788818,-2.710833072662354,-2.710833072662354,-2.711389064788818,-2.711389064788818,-2.710833072662354,-2.710833072662354,-2.710277080535889,-2.710277080535889,-2.709722995758057,-2.709722995758057,-2.709167003631592,-2.709167003631592,-2.708611011505127,-2.708611011505127,-2.708055019378662,-2.708055019378662,-2.707499027252197,-2.707499027252197,-2.703054904937687,-2.703054904937687,-2.701387882232666,-2.701387882232666,-2.69928503036499,-2.698055982589722,-2.698055982589722,-2.69638800621027,-2.69638800621027,-2.69527792930603,-2.69527792930603,-2.694721937179565,-2.694721937179565,-2.694165945053101,-2.694165945053101,-2.693612098693734,-2.693612098693734,-2.693612098693734,-2.693212985992432,-2.693056106567326,-2.693056106567326,-2.693612098693734,-2.693612098693734,-2.693056106567326,-2.693056106567326,-2.690834045410156,-2.690834045410156,-2.688055992126465,-2.688055992126465,-2.686389923095703,-2.686389923095703,-2.685832977294865,-2.685832977294865,-2.684720993041992,-2.684720993041992,-2.683610916137638,-2.683610916137638,-2.682498931884709,-2.682498931884709,-2.681389093399048,-2.681389093399048,-2.680833101272583,-2.680833101272583,-2.680277109146118,-2.680277109146118,-2.679723024368229,-2.679723024368229,-2.678055047988892,-2.678055047988892,-2.676388978958073,-2.676388978958073,-2.675832986831608,-2.675832986831608,-2.674722909927368,-2.674722909927368,-2.673609972000122,-2.673609972000122,-2.672499895095825,-2.672499895095825,-2.67194390296936,-2.67194390296936,-2.670834064483643,-2.670834064483643,-2.670278072357178,-2.670278072357178,-2.669722080230713,-2.669722080230713,-2.669166088104134,-2.669166088104134,-2.668056011199951,-2.668056011199951,-2.667500019073486,-2.667500019073486,-2.666944026947021,-2.666944026947021,-2.666389942169133,-2.666389942169133,-2.665833950042725,-2.665833950042725,-2.66527795791626,-2.66527795791626,-2.665833950042725,-2.665833950042725,-2.666389942169133,-2.666389942169133,-2.666944026947021,-2.666944026947021,-2.666389942169133,-2.666389942169133,-2.665833950042725,-2.665833950042725,-2.66527795791626,-2.66527795791626,-2.663055896758976,-2.663055896758976,-2.660834074020386,-2.660834074020386,-2.660276889801025,-2.660276889801025,-2.659720897674447,-2.659720897674447,-2.659168004989567,-2.659168004989567,-2.658611059188786,-2.658611059188786,-2.656944990158081,-2.656944990158081,-2.656388998031503,-2.656388998031503,-2.65527701377863,-2.65527701377863,-2.654722929000854,-2.654722929000854,-2.65416693687439,-2.65416693687439,-2.653610944747925,-2.653610944747925,-2.65250110626215,-2.65250110626215,-2.651388883590698,-2.651388883590698,-2.648611068725529,-2.648611068725529,-2.646944999694824,-2.646944999694824,-2.645834922790527,-2.645832061767578,-2.645277976989689,-2.645277976989689,-2.644165992736816,-2.644165992736816,-2.643610000610352,-2.643610000610352,-2.643055915832463,-2.643055915832463,-2.641700029373169,-2.641387939453068,-2.641387939453068,-2.641305923461914,-2.640834093093872,-2.640834093093872,-2.640278100967407,-2.640278100967407,-2.639722108840942,-2.639722108840942,-2.638612031936589,-2.638612031936589,-2.637500047683716,-2.637500047683716,-2.636944055557251,-2.636944055557251,-2.635833978652897,-2.635833978652897,-2.635277986526432,-2.635277986526432,-2.634721040725651,-2.634721040725651,-2.634167909622192,-2.634167909622192,-2.633611917495614,-2.633611917495614,-2.634167909622192,-2.634167909622192,-2.634721040725651,-2.634721040725651,-2.635277986526432,-2.635277986526432,-2.634721040725651,-2.634721040725651,-2.634167909622192,-2.634167909622192,-2.633611917495614,-2.633611917495614,-2.633054971694946,-2.633054971694946,-2.632498979568481,-2.632498979568481,-2.631946086883488,-2.631946086883488,-2.631388902664185,-2.631388902664185,-2.63083291053772,-2.63083291053772,-2.630276918411255,-2.630276918411255,-2.629723072052002,-2.62972092628479,-2.629167079925537,-2.629167079925537,-2.628611087798959,-2.628611087798959,-2.628055095672551,-2.628055095672551,-2.627499103546086,-2.627499103546086,-2.626945018768311,-2.626945018768311,-2.626389026641846,-2.626389026641846,-2.625277042388916,-2.625277042388916,-2.624722957611084,-2.624722957611084,-2.624166965484619,-2.624166965484619,-2.623610973358154,-2.623610973358154,-2.623054981231689,-2.623054981231689,-2.622500896453801,-2.622500896453801,-2.621944904327336,-2.621944904327336,-2.621388912200928,-2.621388912200928,-2.62083196640009,-2.62083196640009,-2.62027907371521,-2.62027907371521,-2.619723081588745,-2.619723081588745,-2.619165897369271,-2.619165897369271,-2.618609905242863,-2.618609905242863,-2.61805605888361,-2.61805605888361,-2.617500066757145,-2.617500066757145,-2.61694407463068,-2.61694407463068,-2.616388082504272,-2.616388082504272,-2.614722013473454,-2.614722013473454,-2.614166021346989,-2.614166021346989,-2.613055944442749,-2.613055944442749,-2.61249995231617,-2.61249995231617,-2.611943960189762,-2.611943960189762,-2.611387968063298,-2.611387968063298,-2.610833883285522,-2.610833883285522,-2.610277891159058,-2.610277891159058,-2.609721899032593,-2.609721899032593,-2.609165906906128,-2.609165906906128,-2.608056068420353,-2.608056068420353,-2.606945991516113,-2.606945991516113,-2.605833053588867,-2.605833053588867,-2.604721069335938,-2.604721069335938,-2.603610992431641,-2.603610992431641,-2.601388931274357,-2.601388931274357,-2.599167108535767,-2.599167108535767,-2.597501039504948,-2.597501039504948,-2.594238996505737,-2.591943979263306,-2.591943979263306,-2.588056087493783,-2.588056087493783,-2.587500095367375,-2.587500095367375,-2.58694410324091,-2.58694410324091,-2.586388111114445,-2.586388111114445,-2.58583402633667,-2.58583402633667,-2.585278034210205,-2.585278034210205,-2.585278034210205,-2.58583402633667,-2.58583402633667,-2.584166049957162,-2.584166049957162,-2.582499980926514,-2.582499980926514,-2.581943988800049,-2.581943988800049,-2.58138990402216,-2.58138990402216,-2.580833911895752,-2.580833911895752,-2.579720973968449,-2.579720973968449,-2.577498912811222,-2.577498912811222,-2.57694506645197,-2.57694506645197,-2.573611021041813,-2.573611021041813,-2.573055028915348,-2.573055028915348,-2.572500944137573,-2.572500944137573,-2.571944952010995,-2.571944952010995,-2.571388959884587,-2.571388959884587,-2.570832967758122,-2.570832967758122,-2.569722890853882,-2.569722890853882,-2.569166898727417,-2.569166898727417,-2.568610906600952,-2.568610906600952,-2.565831899642944,-2.565831899642944,-2.564722061157227,-2.564722061157227,-2.561165094375554,-2.560832023620605,-2.560832023620605,-2.560277938842717,-2.560277938842717,-2.558056116104126,-2.558056116104126,-2.555834054946899,-2.555834054946899,-2.55472207069397,-2.55472207069397,-2.553056001663208,-2.553056001663208,-2.551945924758854,-2.551945924758854,-2.55138897895813,-2.55138897895813,-2.550276994705143,-2.550276994705143,-2.549166917800903,-2.549166917800903,-2.548610925674438,-2.548610925674438,-2.548054933547974,-2.548054933547974,-2.546945095062199,-2.546945095062199,-2.546389102935734,-2.546389102935734,-2.545833110809269,-2.545833110809269,-2.545279026031494,-2.545279026031494,-2.544723033905029,-2.544723033905029,-2.544167041778564,-2.544167041778564,-2.543611049651986,-2.543611049651986,-2.543055057525578,-2.543055057525578,-2.542500972747803,-2.542500972747803,-2.541944980621338,-2.541944980621338,-2.540832996368408,-2.540832996368408,-2.540278911590576,-2.540278911590576,-2.539722919464111,-2.539722919464111,-2.539165973663273,-2.539165973663273,-2.538609981536865,-2.538609981536865,-2.538057088851929,-2.538057088851929,-2.537499904632512,-2.537499904632512,-2.536943912506047,-2.536943912506047,-2.537499904632512,-2.537499904632512,-2.538057088851929,-2.538057088851929,-2.537499904632512,-2.537499904632512,-2.536943912506047,-2.536943912506047,-2.535834074020329,-2.535834074020329,-2.536387920379582,-2.536387920379582,-2.536943912506047,-2.536943912506047,-2.538057088851929,-2.538057088851929,-2.538609981536865,-2.538609981536865,-2.538609981536865,-2.538057088851929,-2.538057088851929,-2.537499904632512,-2.537499904632512,-2.536943912506047,-2.536943912506047,-2.536387920379582,-2.536387920379582,-2.536943912506047,-2.536943912506047,-2.536387920379582,-2.536387920379582,-2.535278081893921,-2.535278081893921,-2.534166097640991,-2.534166097640991,-2.533610105514526,-2.533610105514526,-2.533056020736637,-2.533056020736637,-2.532500028610173,-2.532500028610173,-2.385257962826785,-2.386402738219327,-2.65527701377863,-2.65527701377863,-2.655833005905095,-2.655833005905095,-2.656388998031503,-2.656388998031503,-2.656944990158081,-2.656944990158081,-2.657499074935856,-2.657499074935856,-2.658055067062321,-2.658055067062321,-2.658611059188786,-2.658611059188786,-2.659720897674447,-2.659720897674447,-2.66194295883173,-2.66194295883173,-2.66416597366333,-2.66416597366333,-2.664721965789795,-2.664721965789795,-2.665833950042725,-2.665833950042725,-2.666388034820557,-2.666389942169133,-2.666944026947021,-2.666944026947021,-2.668056011199951,-2.668056011199951,-2.668610095977726,-2.668610095977726,-2.669166088104134,-2.669166088104134,-2.670278072357178,-2.670278072357178,-2.670834064483643,-2.670834064483643,-2.67194390296936,-2.67194390296936,-2.672499895095825,-2.672499895095825,-2.673609972000122,-2.673609972000122,-2.674165964126587,-2.674165964126587,-2.675278902053833,-2.675278902053833,-2.676388978958073,-2.676388978958073,-2.676944971084538,-2.676944971084538,-2.677500963210946,-2.677500963210946,-2.6786110401153,-2.6786110401153,-2.679723024368229,-2.679723024368229,-2.680277109146118,-2.680277109146118,-2.680277109146118,-2.680833101272583,-2.680833101272583,-2.681389093399048,-2.681389093399048,-2.681945085525513,-2.681945085525513,-2.682498931884709,-2.682498931884709,-2.683054924011174,-2.683054924011174,-2.684166908264103,-2.684166908264103,-2.685832977294865,-2.685832977294865,-2.686943054199219,-2.686943054199219,-2.687499046325684,-2.687499046325684,-2.688055992126465,-2.688055992126465,-2.68861198425293,-2.68861198425293,-2.690834045410156,-2.690834045410156,-2.693056106567326,-2.693056106567326,-2.693612098693734,-2.693612098693734,-2.694165945053101,-2.694165945053101,-2.694721937179565,-2.694721937179565,-2.69527792930603,-2.69527792930603,-2.696943998336678,-2.696943998336678,-2.699166059493962,-2.699166059493962,-2.700831890106201,-2.700831890106201,-2.704166889190617,-2.704166889190617,-2.705276966094971,-2.705279111862183,-2.705832958221436,-2.705832958221436,-2.7063889503479,-2.7063889503479,-2.706944942474308,-2.706944942474308,-2.707499027252197,-2.707499027252197,-2.708055019378662,-2.708055019378662,-2.708611011505127,-2.708611011505127,-2.709167003631592,-2.709167003631592,-2.711389064788818,-2.711389064788818,-2.711945056915283,-2.711945056915283,-2.713054895401001,-2.713054895401001,-2.714720964431763,-2.714720964431763,-2.715277910232544,-2.715277910232544,-2.716389894485474,-2.716389894485474,-2.716943979263249,-2.716943979263249,-2.718055963516122,-2.718055963516122,-2.7186119556427,-2.7186119556427,-2.719166040420475,-2.719166040420475,-2.72083401679987,-2.72083401679987,-2.722500085830688,-2.722500085830688,-2.725277900695687,-2.725277900695687,-2.728054046630859,-2.728054046630859,-2.729166984558105,-2.729166984558105,-2.730833053588754,-2.730833053588754,-2.731945037841797,-2.731945037841797,-2.735933065414429,-2.738054990768433,-2.738054990768433,-2.738610982894897,-2.738610982894897,-2.739721059799137,-2.739721059799137,-2.740277051925602,-2.740277051925602,-2.741389989852848,-2.741389989852848,-2.742500066757202,-2.742500066757202,-2.743056058883667,-2.743056058883667,-2.744721889495793,-2.744721889495793,-2.745277881622258,-2.745277881622258,-2.745834112167358,-2.745834112167358,-2.745834112167358,-2.746390104293823,-2.746390104293823,-2.746943950653076,-2.746943950653076,-2.748055934905949,-2.748055934905949,-2.75083398818964,-2.75083398818964,-2.751388072967529,-2.751388072967529,-2.755279064178353,-2.755279064178353,-2.756944894790649,-2.756944894790649,-2.759166955947876,-2.759166955947876,-2.759722948074341,-2.759722948074341,-2.760277032852116,-2.760277032852116,-2.760833024978581,-2.760833024978581,-2.762499094009399,-2.762499094009399,-2.763055086135864,-2.763055086135864,-2.76472091674799,-2.764723062515202,-2.765832901000863,-2.765832901000863,-2.768611907958928,-2.768611907958928,-2.769721984863281,-2.769721984863281,-2.772500038146973,-2.772500038146973,-2.772500038146973,-2.774166107177678,-2.774166107177678,-2.776387929916382,-2.776387929916382,-2.780277967453003,-2.780277967453003,-2.780832052230778,-2.780834913253784,-2.781388044357243,-2.781388044357243,-2.781944990158024,-2.781944990158024,-2.782500982284489,-2.782500982284489,-2.783054113388005,-2.783054113388005,-2.783054113388005,-2.783611059188843,-2.783611059188843,-2.783054113388005,-2.783054113388005,-2.783611059188843,-2.783611059188843,-2.784167051315308,-2.784167051315308,-2.784723043441716,-2.784723043441716,-2.78527903556818,-2.78527903556818,-2.785832881927433,-2.785832881927433,-2.786389112472534,-2.786389112472534,-2.786945104598999,-2.786945104598999,-2.787498950958252,-2.787501096725464,-2.78805494308466,-2.78805494308466,-2.788610935211125,-2.788610935211125,-2.78916692733759,-2.78916692733759,-2.789722919464054,-2.789722919464054,-2.79249906539917,-2.79249906539917,-2.794167995452881,-2.794167995452881,-2.796746231643599,-2.797499895095825,-2.797499895095825,-2.797874779713257,-2.805278062820378,-2.805278062820378,-2.805834054946843,-2.805834054946843,-2.806387901306039,-2.806387901306039,-2.806943893432617,-2.806943893432617,-2.807499885559082,-2.807499885559082,-2.808057069778442,-2.808057069778442,-2.808609962463322,-2.808609962463322,-2.809166908264103,-2.809166908264103,-2.809722900390568,-2.809722900390568,-2.810278892517033,-2.810278892517033,-2.810832977294922,-2.810832977294922,-2.810832977294922,-2.810911893844491,-2.811388969421387,-2.811388969421387,-2.811388969421387,-2.811944961547852,-2.811944961547852,-2.81250095367426,-2.81250095367426,-2.813055038452148,-2.813055038452148,-2.813611030578613,-2.813611030578613,-2.814167022705078,-2.814167022705078,-2.814723014831543,-2.814723014831543,-2.815277099609261,-2.815277099609261,-2.81583309173584,-2.81583309173584,-2.816389083862305,-2.816389083862305,-2.816487873253325,-2.815910073774157,-2.815277099609261,-2.815277099609261,-2.814167022705078,-2.814167022705078,-2.813055038452148,-2.813055038452148,-2.81250095367426,-2.81250095367426,-2.811944961547852,-2.811944961547852,-2.811388969421387,-2.811388969421387,-2.810832977294922,-2.810832977294922,-2.810278892517033,-2.810278892517033,-2.809722900390568,-2.809722900390568,-2.809166908264103,-2.809166908264103,-2.808609962463322,-2.808609962463322,-2.808057069778442,-2.808057069778442,-2.807499885559082,-2.807499885559082,-2.808609962463322,-2.808609962463322,-2.808057069778442,-2.808057069778442,-2.807499885559082,-2.807499885559082,-2.806943893432617,-2.806943893432617,-2.806387901306039,-2.806387901306039,-2.805834054946843,-2.805834054946843,-2.806387901306039,-2.806387901306039,-2.805834054946843,-2.805834054946843,-2.806387901306039,-2.806387901306039,-2.806943893432617,-2.806943893432617,-2.806387901306039,-2.806387901306039,-2.806943893432617,-2.806943893432617,-2.806387901306039,-2.806387901306039,-2.805834054946843,-2.805834054946843,-2.805278062820378,-2.805278062820378,-2.805834054946843,-2.805834054946843,-2.806387901306039,-2.806387901306039,-2.805834054946843,-2.805834054946843,-2.804722070693913,-2.804722070693913,-2.804166078567448,-2.804166078567448,-2.804166078567448,-2.80361008644104,-2.80361008644104,-2.803056001663094,-2.803056001663094,-2.80361008644104,-2.80361008644104,-2.803056001663094,-2.803056001663094,-2.804166078567448,-2.804166078567448,-2.804722070693913,-2.804722070693913,-2.805834054946843,-2.805834054946843,-2.806387901306039,-2.806387901306039,-2.806943893432617,-2.806943893432617,-2.808609962463322,-2.808609962463322,-2.809166908264103,-2.809166908264103,-2.809722900390568,-2.809722900390568,-2.809166908264103,-2.809166908264103,-2.808057069778442,-2.808053970336857,-2.807499885559082,-2.807499885559082,-2.809166908264103,-2.809166908264103,-2.810278892517033,-2.810278892517033,-2.811388969421387,-2.811388969421387,-2.810832977294922,-2.810832977294922,-2.809166908264103,-2.809166908264103,-2.810278892517033,-2.810278892517033,-2.810832977294922,-2.810832977294922,-2.81250095367426,-2.81250095367426,-2.814723014831543,-2.814723014831543,-2.814865192775538],"lat":[56.44458389282227,56.47791671752924,56.47791671752924,56.47819519042963,56.47819519042963,56.47847366333002,56.47847366333002,56.47874832153343,56.47874832153343,56.47902679443359,56.47902679443359,56.47930526733398,56.47930526733398,56.47958374023438,56.47958374023438,56.47930526733398,56.47930526733398,56.47958374023438,56.47958374023438,56.47986221313494,56.47986221313494,56.47958374023438,56.47958374023438,56.47930526733398,56.47930526733398,56.47902679443359,56.47902679443359,56.47874832153343,56.47874832153343,56.47847366333002,56.47847366333002,56.45842794951487,56.45728317412233,56.4954185485841,56.4954185485841,56.49625015258789,56.49625015258789,56.49652862548828,56.49652862548828,56.49680709838867,56.49680709838867,56.49708175659202,56.49708175659202,56.49736022949241,56.49736022949241,56.49763870239281,56.49763870239281,56.4979171752932,56.4979171752932,56.49819564819336,56.49819564819336,56.49847412109375,56.49847412109375,56.49874877929699,56.49874877929699,56.49902725219738,56.49902725219738,56.49930572509771,56.49930572509771,56.49902725219738,56.49902725219738,56.49902725219738,56.49930572509771,56.49930572509771,56.4995841979981,56.4995841979981,56.49986267089849,56.49986267089849,56.50013732910151,56.50013732910151,56.5004158020019,56.5004158020019,56.50084304809587,56.50097274780285,56.50100708007818,56.50102233886724,56.50180435180664,56.50180435180664,56.5029182434082,56.5029182434082,56.50319290161156,56.50319290161156,56.50347137451195,56.50347137451195,56.50374984741234,56.50374984741234,56.50402832031273,56.50402832031273,56.50430679321312,56.50430679321312,56.5045814514163,56.50458526611328,56.50485992431652,56.50485992431652,56.50513839721691,56.50513839721691,56.5054168701173,56.5054168701173,56.50569534301763,56.50569534301763,56.50624847412109,56.50624847412109,56.50680541992182,56.50680541992182,56.50708389282221,56.50708389282221,56.50736236572277,56.50736236572277,56.50763702392578,56.50763702392578,56.50791549682617,56.50791549682617,56.50819396972656,56.50819396972656,56.50847244262712,56.50847244262712,56.50875091552751,56.50875091552751,56.50958251953148,56.50958251953148,56.50986099243187,56.50986099243187,56.51041793823265,56.51041793823265,56.51069259643583,56.51069259643583,56.51097106933622,56.51097106933622,56.51152801513683,56.51152801513683,56.51208496093756,56.51208496093756,56.51263809204102,56.51263809204102,56.51291656494135,56.51291656494135,56.5140266418457,56.5140266418457,56.51430511474609,56.51430511474609,56.51486206054705,56.51486206054705,56.51541519165045,56.51541519165045,56.5159721374514,56.5159721374514,56.51625061035179,56.51625061035179,56.51652908325218,56.51652908325218,56.51625061035179,56.51625061035179,56.51652908325218,56.51652908325218,56.51680374145519,56.51680374145519,56.51708221435575,56.51708221435575,56.51791763305675,56.51791763305675,56.51819610595714,56.51819610595714,56.51847076416016,56.51847076416016,56.51874923706055,56.51874923706055,56.51902770996094,56.51902770996094,56.51985931396507,56.51985931396507,56.52041625976562,56.52041625976562,56.52069473266602,56.52069473266602,56.52097320556641,56.52097320556641,56.52125167846697,56.52125167846697,56.52152633666998,56.52152633666998,56.52180480957037,56.52180480957037,56.52208328247076,56.52208328247076,56.52236175537132,56.52236175537132,56.52291488647455,56.52291488647455,56.52319335937511,56.52319335937511,56.52347183227567,56.52347183227567,56.52347183227567,56.52375030517607,56.52375030517607,56.52375030517607,56.52402877807629,56.52402877807629,56.52430725097668,56.52430725097668,56.52458190917986,56.52458190917986,56.52486038208008,56.52486038208008,56.52513885498047,56.52513885498047,56.52541732788086,56.52541732788086,56.52569580078119,56.52569580078119,56.5259704589846,56.5259704589846,56.52624893188499,56.52624893188499,56.52680587768555,56.52680587768555,56.52763748168957,56.52763748168957,56.52819442749029,56.52819442749029,56.52847290039068,56.52847290039068,56.52958297729504,56.52958297729504,56.53013992309599,56.53013992309599,56.53041839599621,56.53041839599621,56.53069305419939,56.53069305419939,56.53097152709978,56.53097152709978,56.53152847290039,56.53152847290039,56.53208160400413,56.53208160400413,56.53291702270531,56.53291702270531,56.53319549560547,56.53319549560547,56.5337486267091,56.5337486267091,56.53402709960949,56.53402709960949,56.5348625183106,56.5348625183106,56.53541564941401,56.53541564941401,56.5356941223144,56.5356941223144,56.53652954101591,56.53652954101591,56.53708267211931,56.53708267211931,56.5373611450197,56.5373611450197,56.53763961791992,56.53763961791992,56.53791809082031,56.53791809082031,56.53847122192406,56.53847122192406,56.53930664062523,56.53930664062523,56.53958511352539,56.53958511352539,56.53985977172863,56.53985977172863,56.54041671752941,56.54041671752941,56.54069519042974,56.54069519042974,56.54097366333013,56.54097366333013,56.54152679443354,56.54152679443354,56.54180526733393,56.54180526733393,56.54208374023432,56.54208374023432,56.54236221313488,56.54236221313488,56.54264068603544,56.54264068603544,56.54347229003923,56.54347229003923,56.54375076293962,56.54375076293962,56.54402923583984,56.54402923583984,56.54541778564476,56.54541778564476,56.54597091674833,56.54597091674833,56.54624938964855,56.54624938964855,56.54680633544933,56.54680633544933,56.54708480834967,56.54708480834967,56.54763793945312,56.54763793945312,56.54791641235346,56.54791641235346,56.5487518310548,56.5487518310548,56.54902648925781,56.54902648925781,56.5493049621582,56.5493049621582,56.54958343505859,56.54958343505859,56.54986190795915,56.54986190795915,56.55014038085955,56.55014038085955,56.55041503906256,56.55041503906256,56.55069351196295,56.55069351196295,56.55097198486351,56.55097198486351,56.55069351196295,56.55069351196295,56.55041503906256,56.55041503906256,56.55041503906256,56.55069351196295,56.55069351196295,56.55097198486351,56.55097198486351,56.5512504577639,56.5512504577639,56.55152893066429,56.55152893066429,56.55180740356468,56.55180740356468,56.55208206176786,56.55208206176786,56.55271148681646,56.55347061157227,56.55347061157227,56.55402755737305,56.55402755737305,56.55374908447266,56.55374908447266,56.55402755737305,56.55402755737305,56.55430603027338,56.55430603027338,56.55458450317377,56.55458450317377,56.55486297607416,56.55486297607416,56.55513763427757,56.55513763427757,56.55541610717773,56.55541610717773,56.55569458007812,56.55569839477567,56.55652618408209,56.55652618408209,56.55680465698248,56.55680465698248,56.55736160278343,56.55736160278343,56.55764007568382,56.55764007568382,56.55819320678722,56.55819320678722,56.55847167968778,56.55847167968778,56.55875015258817,56.55875015258817,56.55902862548839,56.55902862548839,56.55930709838879,56.55930709838879,56.55958175659197,56.55958175659197,56.55986022949219,56.55986022949219,56.55986022949219,56.55958175659197,56.55958175659197,56.55930709838879,56.55930709838879,56.55902862548839,56.55902862548839,56.55930709838879,56.55930709838879,56.55958175659197,56.55958175659197,56.55986022949219,56.55986022949219,56.56013870239258,56.56013870239258,56.56041717529297,56.56041717529297,56.5606956481933,56.5606956481933,56.56097412109369,56.56097412109369,56.5612487792971,56.5612487792971,56.56152725219749,56.56152725219749,56.56180572509766,56.56180572509766,56.56236267089844,56.56236267089844,56.56263732910168,56.56263732910168,56.56291580200201,56.56291580200201,56.5631942749024,56.5631942749024,56.56347274780279,56.56347274780279,56.56375122070335,56.56375122070335,56.56402587890619,56.56402969360374,56.56430435180658,56.56430435180658,56.56458282470714,56.56458282470714,56.56486129760771,56.56486129760771,56.5651397705081,56.5651397705081,56.56541824340832,56.56541824340832,56.5656929016115,56.5656929016115,56.56597137451189,56.56597137451189,56.56624984741211,56.56624984741211,56.56680679321289,56.56680679321289,56.56819534301758,56.56819534301758,56.56874847412121,56.56874847412121,56.56958389282232,56.56958389282232,56.56986236572271,56.56986236572271,56.57013702392572,56.57013702392572,56.57125091552763,56.57125091552763,56.57152938842802,56.57152938842802,56.57180404663086,56.57180404663086,56.57208251953142,56.57208251953142,56.57231903076195,56.57291793823242,56.57291793823242,56.57319259643577,56.57319259643577,56.57347106933616,56.57347106933616,56.57374954223656,56.57374954223656,56.5745849609375,56.5745849609375,56.57485961914074,56.57485961914074,56.57513809204113,56.57513809204113,56.57541656494152,56.57541656494152,56.57569503784185,56.57569503784185,56.57736206054699,56.57736206054699,56.57764053344755,56.57764053344755,56.57771300211645,56.57405026416164,56.30044894534403,56.31394890897044,56.31624984741234,56.31624984741234,56.31763839721691,56.31763839721691,56.31791687011724,56.31791687011724,56.31819534301763,56.31819534301763,56.31874847412104,56.31874847412104,56.31902694702143,56.31902694702143,56.31930541992182,56.31930541992182,56.31958389282238,56.31958389282238,56.31986236572294,56.31986236572294,56.32013702392578,56.32013702392578,56.32041549682617,56.32041549682617,56.32013702392578,56.32013702392578,56.31986236572294,56.31986236572294,56.32041549682617,56.32041549682617,56.32013702392578,56.32013702392578,56.32041549682617,56.32041549682617,56.32069396972673,56.32069396972673,56.32125091552734,56.32125091552734,56.32152938842773,56.32152938842773,56.32125091552734,56.32125091552734,56.32097244262712,56.32097244262712,56.32069396972673,56.32069396972673,56.32041549682617,56.32041549682617,56.32013702392578,56.32013702392578,56.32041549682617,56.32041549682617,56.32180404663109,56.32180404663109,56.32208251953148,56.32208251953148,56.32236099243187,56.32236099243187,56.32319259643583,56.32319259643583,56.32338714599609,56.32347106933605,56.32347106933605,56.32374954223644,56.32374954223644,56.32402801513683,56.32402801513683,56.32430648803717,56.32430648803717,56.32541656494135,56.32541656494135,56.32569503784174,56.32569503784174,56.3259735107423,56.3259735107423,56.32624816894531,56.32624816894531,56.3265266418457,56.3265266418457,56.32680511474609,56.32680511474609,56.3265266418457,56.3265266418457,56.32680511474609,56.32680511474609,56.32708358764665,56.32708358764665,56.32680511474609,56.32680511474609,56.3265266418457,56.3265266418457,56.32624816894531,56.32624816894531,56.3259735107423,56.3259735107423,56.32569503784174,56.32569503784174,56.3259735107423,56.3259735107423,56.32569503784174,56.32569503784174,56.32541656494135,56.32541656494135,56.32513809204096,56.32513809204096,56.32541656494135,56.32541656494135,56.32569503784174,56.32569503784174,56.3259735107423,56.3259735107423,56.32624816894531,56.32624816894531,56.32680511474609,56.32680511474609,56.32736206054705,56.32736206054705,56.32764053344727,56.32764053344727,56.32791519165045,56.32791519165045,56.32819366455101,56.32819366455101,56.3284721374514,56.3284721374514,56.32875061035179,56.32875061035179,56.3284721374514,56.3284721374514,56.32819366455101,56.32819366455101,56.32791519165045,56.32791519165045,56.32764053344727,56.32764053344727,56.32736206054705,56.32736206054705,56.32708358764665,56.32708358764665,56.32680511474609,56.32680511474609,56.32708358764665,56.32708358764665,56.32736206054705,56.32736206054705,56.32708358764665,56.32708358764665,56.32736206054705,56.32736206054705,56.32764053344727,56.32764053344727,56.32791519165045,56.32791519165045,56.32819366455101,56.32819366455101,56.32819366455101,56.3284721374514,56.3284721374514,56.32875061035179,56.32875061035179,56.32902908325218,56.32902908325218,56.32930374145536,56.32930374145536,56.32958221435575,56.32958221435575,56.32986068725597,56.32986068725597,56.33013916015636,56.33013916015636,56.33041763305675,56.33041763305675,56.33069610595709,56.33069610595709,56.331108093262,56.33152770996088,56.33152770996088,56.33208465576166,56.33208465576166,56.33235931396507,56.33235931396507,56.33263778686523,56.33263778686523,56.33235931396507,56.33235931396507,56.33208465576166,56.33208465576166,56.33235931396507,56.33235931396507,56.33263778686523,56.33263778686523,56.33291625976562,56.33291625976562,56.33263778686523,56.33263778686523,56.33235931396507,56.33235931396507,56.33208465576166,56.33208465576166,56.33235931396507,56.33235931396507,56.33263778686523,56.33263778686523,56.33291625976562,56.33291625976562,56.33319473266602,56.33319473266602,56.33347320556658,56.33347320556658,56.33375167846697,56.33375167846697,56.33366775512707,56.33347320556658,56.33347320556658,56.33319473266602,56.33319473266602,56.33314610010024,56.33506585888455,56.33569335937528,56.33569335937528,56.33597183227567,56.33597183227567,56.33625030517589,56.33625030517589,56.33680725097668,56.33680725097668,56.33708190917969,56.33708190917969,56.33772277832054,56.3379173278808,56.33793258666992,56.33874893188499,56.33874893188499,56.33958435058594,56.33958435058594,56.3404159545899,56.3404159545899,56.34069442749029,56.34069442749029,56.34125137329124,56.34125137329124,56.34152603149408,56.34152603149408,56.34180450439464,56.34180450439464,56.34208297729521,56.34208297729521,56.3423614501956,56.3423614501956,56.34263992309582,56.34263992309582,56.34291839599621,56.34291839599621,56.34319305419939,56.34319305419939,56.34375,56.34375,56.34402847290039,56.34402847290039,56.34375,56.34375,56.34319305419939,56.34319305419939,56.34356499200698,56.34375,56.34375,56.34740356828663,56.34791564941401,56.34791564941401,56.34930419921892,56.34930419921892,56.35041809082031,56.35041809082031,56.35208511352539,56.35208511352539,56.35291671752935,56.35291671752935,56.35374832153315,56.35374832153315,56.35514068603544,56.35514068603544,56.35625076293945,56.35625076293945,56.3568038940432,56.3568038940432,56.35791778564476,56.35791778564476,56.35919189453125,56.35930633544928,56.35930633544928,56.35930633544928,56.35998916625988,56.36125183105497,56.36125183105497,56.3618049621582,56.3618049621582,56.36236190795915,56.36238098144543,56.36347198486351,56.36347198486351,56.36402893066429,56.36402893066429,56.36430740356468,56.36430740356468,56.36458206176786,56.36458206176786,56.36513900756847,56.36513900756847,56.36597061157227,56.36597061157227,56.36624908447266,56.36624908447266,56.38791656494146,56.38791656494146,56.38819503784185,56.38819503784185,56.38847351074224,56.38847351074224,56.38874816894526,56.38874816894526,56.39069366455095,56.39069366455095,56.39236068725609,56.39236068725609,56.39430618286138,56.39430618286138,56.39541625976557,56.39541625976557,56.39819335937523,56.39819335937523,56.40097045898438,56.40097045898438,56.4034729003908,56.4034729003908,56.40458297729515,56.40458297729515,56.40541839599632,56.40541839599632,56.4056930541995,56.4056930541995,56.40625000000011,56.40625000000011,56.40680694580089,56.40680694580089,56.40791702270502,56.40791702270502,56.40986251831072,56.40986251831072,56.41180419921886,56.41180419921886,56.41319274902361,56.41319274902361,56.41569519042969,56.41569519042969,56.41597366333008,56.41597366333008,56.41791534423822,56.41791534423822,56.41819381713879,56.41819381713879,56.41847229003935,56.41847229003935,56.42013931274414,56.42013931274414,56.42069625854487,56.42069625854487,56.42152786254906,56.42152786254906,56.42291641235357,56.42291641235357,56.42347335815435,56.42347335815435,56.42708206176781,56.42708206176781,56.42763900756859,56.42763900756859,56.43236160278337,56.43236160278337,56.43277740478544,56.43402862548851,56.43402862548851,56.43513870239269,56.43513870239269,56.43958282470726,56.43958282470726,56.44152832031261,56.44152832031261,56.44235992431641,56.44235992431641,56.4426383972168,56.4426383972168,56.44291687011713,56.44291687011713,56.44319534301752,56.44319534301752,56.44374847412132,56.44374847412132,56.44402694702148,56.44402694702148,56.44374847412132,56.44374847412132,56.44347381591791,56.44347381591791,56.44235992431641,56.44235992431641,56.44208526611334,56.44208145141602,56.441806793213,56.441806793213,56.44124984741222,56.44124984741222,56.44152832031261,56.44152832031261,56.441806793213,56.441806793213,56.44319534301752,56.44319534301752,56.44430541992188,56.44430541992188,56.44486236572283,56.44486236572283,56.44513702392584,56.44513702392584,56.44541549682623,56.44541549682623,56.44569396972662,56.44569396972662,56.44458389282227,56.44458389282227]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[56.3398,56.4661,56.2697],[-2.7967,-2.7375,-2.6036],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,["St Andrews","Buddon Ness","Fife Ness airstrip"],{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":true,"className":"","sticky":true},null]}],"setView":[[56.41,-2.5],10,[]],"limits":{"lat":[56.2697,56.57771300211645],"lng":[-2.816743098392833,-2.385257962826785]}},"evals":[],"jsHooks":[]}</script>
<p>St Andrews Bay, north and east of St Andrews</p>
</div>
</div>
<p>Load the distance sampling survey design R library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dssd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="study-region" class="level2">
<h2 class="anchored" data-anchor-id="study-region">Study Region</h2>
<p>Set up the study region and plot it. The shapefile for this study area is contained within the <code>dssd</code> R library. This shapefile has already been projected from latitude and longitude on to a flat plane and its units are in metres. The first line of code below returns the path for the shapefile within the R library and may vary on different computers. You will then pass this shapefile pathway to the <code>make.region</code> function to set up the survey region. As this shapefile does not have a projection (.prj) file associated with it we should tell <code>dssd</code> the units (m) when we create the survey region.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find the pathway to the file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>shapefile.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"StAndrew.shp"</span>, <span class="at">package =</span> <span class="st">"dssd"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the region using this shapefile</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="fu">make.region</span>(<span class="at">region.name =</span> <span class="st">"St Andrews Bay"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">units =</span> <span class="st">"m"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape =</span> shapefile.name)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the region</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pr6-instructions_files/figure-html/region-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
<figcaption>Study Region</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="coverage" class="level2">
<h2 class="anchored" data-anchor-id="coverage">Coverage</h2>
<p>The next step is to set up a coverage grid. A coverage grid is a grid of regularly spaced points and is used to assess whether each point in the survey region is equally likely to sampled. The coverage grid needs to be created before the coverage simulation is run.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up coverage grid</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cover <span class="ot">&lt;-</span> <span class="fu">make.coverage</span>(region, <span class="at">n.grid.points =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="systematic-parallel-design" class="level2">
<h2 class="anchored" data-anchor-id="systematic-parallel-design">Systematic Parallel Design</h2>
<p>The small survey plane available can complete a total flight time of around 250km (excluding the flight time to and from the landing strip at Fife Ness). Generally, systematic parallel line designs are preferable for aerial surveys as they allow some rest time for observers as the plane travels between transects and avoids the sharp turns associated with zigzag designs.</p>
<p>Firstly, we will consider the design angle. Often animal density is affected by distance to coast so it is probably wise for this survey to orientate lines approximately perpendicular to the coast. To do this we can select a design angle of 90 degrees. We can therefore expect to spend a little more than 40 km (the height of the survey region) on off-effort transit time and might hope to be able to complete around 200km of transects. <code>dssd</code> lets us specify the desired line length as a design parameter and will then choose an appropriate value for transect spacing. We will choose a minus sampling strategy and set the truncation distance to 2km. Note that as our survey region coordinates are in metres we also need to supply the design parameters in metres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the design</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>design.LL200 <span class="ot">&lt;-</span> <span class="fu">make.design</span>(<span class="at">region =</span> region,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transect.type =</span> <span class="st">"line"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">design =</span> <span class="st">"systematic"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">line.length =</span> <span class="dv">200000</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">design.angle =</span> <span class="dv">90</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">edge.protocol =</span> <span class="st">"minus"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">truncation =</span> <span class="dv">2000</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coverage.grid =</span> cover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have defined the design we should check it visually by creating a survey (a single set of transects).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a single survey from the design</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>survey.LL200 <span class="ot">&lt;-</span> <span class="fu">generate.transects</span>(design.LL200)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the region and the survey</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(region, survey.LL200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pr6-instructions_files/figure-html/survey-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption>Single survey generated from the systematicparallel line design</figcaption>
</figure>
</div>
</div>
</div>
<p>The survey consists of parallel systematically spaced transects running horizontally across the survey region roughly perpendicular to the coast as we wanted. We can also view the details of the survey which will tell us what spacing <code>dssd</code> used to try and achieve a line length of 200 km.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the survey details</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>survey.LL200</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   Strata St Andrews Bay:
   _______________________
Design:  systematically spaced parallel transects
Spacing:  4937.5
Line length: 199960.8
Trackline length: 248012.3
Cyclic trackline length: 284758.4
Number of samplers:  8
Design angle:  90
Edge protocol:  minus
Covered area:  779476845
Strata coverage: 78.93%
Strata area:  987500079

   Study Area Totals:
   _________________
Line length: 199960.8
Trackline length: 248012.3
Cyclic trackline length: 284758.4
Number of samplers:  8
Covered area:  779476845
Average coverage: 78.93%</code></pre>
</div>
</div>
<p>The spacing used by <code>dssd</code> was 4938m which gives us 8 samplers and a coverage of just under 80%. In addition, this example survey has a line length of just under 200km and a trackline length of just over 248 km. However, given the random nature of the design and the fact that the width of the study region is not constant everybody should get slightly different values. Although the trackline length was just under 250km it is not sufficient to only look at one survey, we need to know that all surveys under this design will have a trackline length of &lt; 250km.</p>
<p>To assess the design statistics across many surveys we will now run a coverage simulation. This simulation will randomly generate many surveys from our design and record coverage as well as various statistics including line length and trackline length. As we know that coverage for a parallel line design is largely uniform (apart from edge effects due to minus sampling) we do not need to run too many repetitions, 100 should be sufficient to give us an indication of the range of line lengths and trackline lengths for this design.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the coverage simulation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>design.LL200 <span class="ot">&lt;-</span> <span class="fu">run.coverage</span>(design.LL200, <span class="at">reps =</span> <span class="dv">100</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>design.LL200</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Examine the design statistics. The mean line length should be around 200km (200,000 m). Now look at the maximum trackline length, we need this value to be less than 250km (250,000 m).</p>
<p>Use the results of this simulation to create some new designs based on various spacings to find the maximum line length that can be achieved without risking exceeding the maximum trackline length of 250km (remember to generate a line length of 200km <code>dssd</code> selected a spacing of 4938m). Try transect spacings of 5000m or 5500m.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the design</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>design.space500 <span class="ot">&lt;-</span> <span class="fu">make.design</span>(<span class="at">region =</span> region,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transect.type =</span> <span class="st">"line"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">design =</span> <span class="st">"systematic"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">spacing =</span> <span class="dv">5000</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">design.angle =</span> <span class="dv">90</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">edge.protocol =</span> <span class="st">"minus"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">truncation =</span> <span class="dv">2000</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coverage.grid =</span> cover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>What spacing would you select for this design?</li>
<li>What is the maximum trackline length for the design you have selected?</li>
<li>What on-effort line length are we likely to achieve?</li>
</ul>
</div>
</div>
</section>
<section id="zigzag-design" class="level2">
<h2 class="anchored" data-anchor-id="zigzag-design">Zigzag Design</h2>
<p>Zigzag designs are often more efficient in their use of effort having less off-effort transit time between transects. For this survey another option would be to complete a boat-based survey. The boat survey will have the same total effort available allowing us a trackline length of 250km.</p>
<p>Define a zigzag design for the same region. For zigzag designs the design angle has a different definition, it describes the angle across which the zigzags are constructed. Set the vertical design angle to 0. Zigzag designs also require an additional argument as zigzags can only be created inside convex shapes. Specify the bounding shape, choose a convex hull as it is more efficient than a minimum bounding rectangle. A convex hull works as if we were stretching an elastic band around the survey region. The code below shows you how to create the zigzag design, you should then create a single realisation of this design and plot it to check it looks acceptable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the zigzag design</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>design.zz<span class="fl">.4500</span> <span class="ot">&lt;-</span> <span class="fu">make.design</span>(<span class="at">region =</span> region,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transect.type =</span> <span class="st">"line"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">design =</span> <span class="st">"eszigzag"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">spacing =</span> <span class="dv">4500</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">design.angle =</span> <span class="dv">0</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">edge.protocol =</span> <span class="st">"minus"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bounding.shape =</span> <span class="st">"convex.hull"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">truncation =</span> <span class="dv">2000</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coverage.grid =</span> cover)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>survey.zz <span class="ot">&lt;-</span> <span class="fu">generate.transects</span>(design.zz<span class="fl">.4500</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(region, survey.zz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pr6-instructions_files/figure-html/zzdesign-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption>Single survey generated from the equalspaced zigzag design</figcaption>
</figure>
</div>
</div>
</div>
<p>Run a coverage simulation to verify that we have stayed within the restraints of our survey effort; a total trackline length of &lt; 250km. Run the coverage simulation with more repetitions to also assess the coverage.</p>
<p>Examine the design statistics.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Does this design meet our survey effort constraint?</li>
<li>What is the maximum total trackline length for this design?</li>
<li>What line length are we likely to achieve with this design?</li>
<li>Is this higher or lower than the systematic parallel design?</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the coverage simulation</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>design.zz<span class="fl">.4500</span> <span class="ot">&lt;-</span> <span class="fu">run.coverage</span>(design.zz<span class="fl">.4500</span>, <span class="at">reps =</span> <span class="dv">500</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the design statistics</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>design.zz<span class="fl">.4500</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Examine the coverage. Sometimes with zigzag surveys generated inside convex hulls produce areas of higher coverage in narrower parts of the survey region at either end of the design axis. One of the easiest ways to assess coverage is visually by plotting the coverage grid.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the coverage grid</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(design.zz<span class="fl">.4500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Do you think the coverage scores look uniform across the study region?</li>
<li>Given the lack of uniformity, where are they higher/lower?</li>
<li>Why do you think this is?
<ul>
<li>Note, revisit one of the parallel line designs and plot the coverage scores to compare (although there are fewer repetitions you can still get an idea of coverage).</li>
</ul></li>
</ul>
</div>
</div>
<hr>
<hr>
</section>
</section>
<section id="point-transect-bird-survey-in-tentsmuir-forest" class="level1">
<h1>Point Transect Bird Survey in Tentsmuir Forest</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exericse objective
</div>
</div>
<div class="callout-body-container callout-body">
<p>Design a point transect survey looking at songbird abundance in Tentsmuir Forest so that separate estimates of abundance can be obtained for the two strata.</p>
</div>
</div>
<p>Tenstsmuir Forest is a mature pine forest located on the east coast of Scotland ~10km north of St Andrews. The western area of Tentsmuir around Morton Lochs is of special interest in this study as this part of the forest forms part of the Tentsmuir National Nature Reserve. This study region has therefore been divided into two stratum, the first is the main part of the forest and the second is the area of forest adjacent to Morton Lochs.</p>
<p>Load the distance sampling survey design R library and also the spatial library <em>sf</em>. The <em>sf</em> library needs to be loaded in this example as we need to project the survey region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dssd)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE</code></pre>
</div>
</div>
<section id="projecting-your-study-region" class="level2">
<h2 class="anchored" data-anchor-id="projecting-your-study-region">Projecting your Study Region</h2>
<p>This exercise demonstrates how to deal with unprojected shapefiles. Study areas should always be projected onto a flat plane before you use them to design your survey. This is because in most parts of the world one degree latitude is not the same in distance as one degree longitude. If we didnt project, our study region and any surveys generated in it, would be distorted possibly leading to non-uniform coverage.</p>
<p>Load the study region and project it onto a flat plane using an Albers Equal Area Conical projection. As we have to project the shapefile we load the shape object separately instead of directly into a region object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the unprojected shapefile</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>shapefile.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"TentsmuirUnproj.shp"</span>, <span class="at">package =</span> <span class="st">"dssd"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>sf.shape <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(shapefile.name)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check current coordinate reference system</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(sf.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a European Albers Equal Area projection</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>proj4string <span class="ot">&lt;-</span> <span class="st">"+proj=aea +lat_1=56 +lat_2=62 +lat_0=50 +lon_0=-3 +x_0=0 </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="st">                +y_0=0 +ellps=intl +units=m"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Project the study area on to a flat plane</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>projected.shape <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(sf.shape, <span class="at">crs =</span> proj4string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create the region object for <code>dssd</code> using the projected shape and plot it to check what it looks like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the survey region in dssd</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>region.tm <span class="ot">&lt;-</span> <span class="fu">make.region</span>(<span class="at">region.name =</span> <span class="st">"Tentsmuir"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">strata.name =</span> <span class="fu">c</span>(<span class="st">"Main Area"</span>, <span class="st">"Morton Lochs"</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape =</span> projected.shape)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the survey region</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(region.tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pr6-instructions_files/figure-html/makeregion-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption>Tentsmuir Forest: showing the main stratumand the Morton Loch stratum.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="coverage-1" class="level2">
<h2 class="anchored" data-anchor-id="coverage-1">Coverage</h2>
<p>Set up a coverage grid. A coverage grid is a grid of regularly spaced points and is used to assess whether each point in the survey region is equally likely to sampled. The coverage grid needs to be created before the coverage simulation is run.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up coverage grid</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cover.tm <span class="ot">&lt;-</span> <span class="fu">make.coverage</span>(region.tm, <span class="at">n.grid.points =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="design" class="level2">
<h2 class="anchored" data-anchor-id="design">Design</h2>
<p>Set up a systematic point transect design. We will assume that we have sufficient resources to survey 40 point transects. As the Morton Lochs stratum is of special interest we will give it higher coverage. We will therefore explicitly allocate 25 samplers to the main stratum and 15 to the Morton Lochs stratum (note that the area of the Morton Lochs stratum is much small than the main stratum). If we wanted to allocate the same effort to both stratum we could provide the samplers argument with the single value of 40 and it would divide the effort equally between the strata. We will leave the design angle as 0 and set the truncation distance to 100 m. We will use a minus sampling approach at the edges.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>What are the analysis implications of a design with unequal coverage?</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a multi strata systematic point transect design</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>design.tm <span class="ot">&lt;-</span> <span class="fu">make.design</span>(<span class="at">region =</span> region.tm,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">transect.type =</span> <span class="st">"point"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">design =</span> <span class="st">"systematic"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">samplers =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">15</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">design.angle =</span> <span class="dv">0</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">edge.protocol =</span> <span class="st">"minus"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">truncation =</span> <span class="dv">100</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">coverage.grid =</span> cover.tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generate-a-survey" class="level2">
<h2 class="anchored" data-anchor-id="generate-a-survey">Generate a Survey</h2>
<p>You will now generate a single survey from this design and plot it inside the survey region to check what it looks like. If you want to check whether the covered areas of the samplers in the Morton Lochs stratum overlap add the argument <code>covered.area = TRUE</code> to the plot function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a single survey from the design</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>survey.tm <span class="ot">&lt;-</span> <span class="fu">generate.transects</span>(design.tm)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the region and the survey</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(region.tm, survey.tm, <span class="at">covered.area =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pr6-instructions_files/figure-html/surveytm-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption>Single survey generated from the systematicparallel line design</figcaption>
</figure>
</div>
</div>
</div>
<p>Examine the survey information.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>What spacing was used in each strata to try and achieve the desired number of samplers?</li>
<li>Did your survey achieve exactly the number of samplers you requested?</li>
<li>How much does coverage differ between the two strata for this realisation?</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display survey information</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>survey.tm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="save-coordinates-to-a-file" class="level3">
<h3 class="anchored" data-anchor-id="save-coordinates-to-a-file">Save coordinates to a file</h3>
<p>If this survey is to be conducted in the field, you will want the coordinates that you can load into a handheld GPS. The function <code>write.transects()</code> can write waypoints of the survey (in this case the point transect stations) to text, comma-separated value or GPX files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.transects</span>(survey.tm,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">dsn =</span> <span class="st">"tentsmuir-points.gpx"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"points"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">dataset.options =</span> <span class="st">"GPX_USE_EXTENSIONS=yes"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">proj4string=</span>sf<span class="sc">::</span><span class="fu">st_crs</span>(sf.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Writing layer `points' to data source `tentsmuir-points.gpx' using driver `GPX'
Writing 43 features with 0 fields and geometry type Point.</code></pre>
</div>
</div>
<p>The GPX file can be transferred to a GPS, or viewed using Google Earth.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="google-earth.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Realised survey with locations written to GPX file and imported into Google Earth.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="assessing-coverage-and-design-statistics" class="level2">
<h2 class="anchored" data-anchor-id="assessing-coverage-and-design-statistics">Assessing Coverage and Design Statistics</h2>
<p>We will now run a coverage simulation to assess how much the number of samplers and average coverage varies between surveys. We will also be able to assess how coverage varies spatially to see if edge effects are of concern.</p>
<p>View the design statistics.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>What is the minimum number of samplers you will achieve in each strata?</li>
<li>Is this sufficient to complete separate analyses in each stratum?</li>
</ul>
</div>
</div>
<p>Plot the coverage scores.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Does it appear that there is even coverage within each strata?
<ul>
<li>As there is such a difference in the range of coverage scores between strata you may need to plot each strata individually.</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the design statistics</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(design.tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   Strata Main Area:
   __________________
Design:  systematically spaced transects
Spacing:  NA
Number of samplers:  25
Design angle:  0
Edge protocol:  minus

   Strata Morton Lochs:
   _____________________
Design:  systematically spaced transects
Spacing:  NA
Number of samplers:  15
Design angle:  0
Edge protocol:  minus

Strata areas:  14108643, 715265
Region units:  m
Coverage Simulation repetitions:  100

    Number of samplers:
    
        Main Area Morton Lochs Total
Minimum      22.0         13.0  36.0
Mean         25.1         15.1  40.2
Median       25.0         15.0  40.0
Maximum      27.0         18.0  44.0
sd            0.9          1.1   1.3

    Covered area:
    
        Main Area Morton Lochs      Total
Minimum 683662.63    363258.99 1076099.58
Mean    768186.34    420283.45 1188469.79
Median  772479.34    417730.22 1188447.46
Maximum 816669.52    468461.70 1264365.86
sd       25071.81     25394.87   32875.01

    % of region covered:
    
        Main Area Morton Lochs Total
Minimum      4.85        50.79  7.26
Mean         5.44        58.76  8.02
Median       5.48        58.40  8.02
Maximum      5.79        65.49  8.53
sd           0.18         3.55  0.22

    Coverage Score Summary:
    
         Main Area Morton Lochs      Total
Minimum 0.00000000    0.2200000 0.00000000
Mean    0.05483087    0.5750000 0.08094378
Median  0.05000000    0.6450000 0.06000000
Maximum 0.15000000    0.7800000 0.78000000
sd      0.02997747    0.1456197 0.12170445</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the coverage scores</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(design.tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Pr6-instructions_files/figure-html/coveragetmdisplay-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coverage scores for individual strata could be plotted separately</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(design.tm, strata.id = 1)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(design.tm, strata.id = 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>