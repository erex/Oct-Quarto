<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Centre for Research into Ecological and Environmental Modelling   University of St Andrews">
<meta name="dcterms.date" content="2025-09-11">

<title>Bias in stratum-specific abundance estimates – Distance sampling workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-b663525e4b92bb903b2199e2d401bf36.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-fd5e3b3a1784fb96fdc73af194a4e8cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YWQ3ZB9MVM"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-YWQ3ZB9MVM', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

<script src="../site_libs/leaflet-1.3.1/leaflet.js"></script>

<link href="../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

<script src="../site_libs/proj4-2.6.2/proj4.min.js"></script>

<script src="../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

<link href="../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

<script src="../site_libs/leaflet-binding-2.2.3/leaflet.js"></script>

<script src="../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>

<script src="../site_libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js"></script>

<script type="text/javascript">

    (function(c,l,a,r,i,t,y){

        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};

        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;

        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);

    })(window, document, "clarity", "script", "lk4dxekwqr");

</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="../include/webex.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Distance sampling workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Pr1/sampling.html"> 
<span class="menu-text">Sampling</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr2/detnfns.html"> 
<span class="menu-text">Detection functions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr3/criticism.html"> 
<span class="menu-text">Criticism</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr4/precision.html"> 
<span class="menu-text">Precision</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr5/points.html"> 
<span class="menu-text">Points</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr6/design.html"> 
<span class="menu-text">Design</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Pr7/strata.html" aria-current="page"> 
<span class="menu-text">Strata</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr8/covariates.html"> 
<span class="menu-text">Covariates</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr9/multipliers.html"> 
<span class="menu-text">Multipliers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../extras/extras.html"> 
<span class="menu-text">Extras</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Pr7/stratumspecific-bias.html">Bias in stratum-specific abundance estimates</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr7/strata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stratification practical 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr7/Pr7-instructions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis of stratified survey data 💻</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr7/detecting-differences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Detecting differences in density estimates</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr7/stratumspecific-bias.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Bias in stratum-specific abundance estimates</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr7/Prac7_solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis of data from stratified surveys <strong>solution</strong> 💡</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr7/prac7-tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial–analysis of stratified surveys ✏️</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#study-area" id="toc-study-area" class="nav-link" data-scroll-target="#study-area">Study area</a>
  <ul class="collapse">
  <li><a href="#north-sea-study-area" id="toc-north-sea-study-area" class="nav-link" data-scroll-target="#north-sea-study-area">North Sea study area</a></li>
  </ul></li>
  <li><a href="#population-specification" id="toc-population-specification" class="nav-link" data-scroll-target="#population-specification">Population specification</a></li>
  <li><a href="#survey-design" id="toc-survey-design" class="nav-link" data-scroll-target="#survey-design">Survey design</a>
  <ul class="collapse">
  <li><a href="#properties-of-the-design" id="toc-properties-of-the-design" class="nav-link" data-scroll-target="#properties-of-the-design">Properties of the design</a></li>
  </ul></li>
  <li><a href="#what-analysis-to-conduct" id="toc-what-analysis-to-conduct" class="nav-link" data-scroll-target="#what-analysis-to-conduct">What analysis to conduct</a></li>
  <li><a href="#heart-of-the-simulation" id="toc-heart-of-the-simulation" class="nav-link" data-scroll-target="#heart-of-the-simulation">Heart of the simulation</a>
  <ul class="collapse">
  <li><a href="#loop-over-delta-difference-in-sigma-between-strata" id="toc-loop-over-delta-difference-in-sigma-between-strata" class="nav-link" data-scroll-target="#loop-over-delta-difference-in-sigma-between-strata">Loop over <span class="math inline">\(\Delta\)</span> difference in <span class="math inline">\(\sigma\)</span> between strata</a></li>
  </ul></li>
  <li><a href="#simulation-findings" id="toc-simulation-findings" class="nav-link" data-scroll-target="#simulation-findings">Simulation findings</a>
  <ul class="collapse">
  <li><a href="#conclusions-from-this-portion-of-study" id="toc-conclusions-from-this-portion-of-study" class="nav-link" data-scroll-target="#conclusions-from-this-portion-of-study">Conclusions from this portion of study</a></li>
  <li><a href="#model-selection-sensitivity" id="toc-model-selection-sensitivity" class="nav-link" data-scroll-target="#model-selection-sensitivity">Model selection sensitivity</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bias in stratum-specific abundance estimates</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Centre for Research into Ecological and Environmental Modelling <br> <strong>University of St Andrews</strong> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 11, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Demonstration
</div>
</div>
<div class="callout-body-container callout-body">
<p>Distance sampling simulation where detection functions differ between strata. When stratum-specific abundance estimates are produced using a pooled detection function, bias arises. The magnitude of the bias depends upon the magnitude of the difference in the detection functions.</p>
</div>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>We tell participants in the introductory distance sampling workshop of the perils of estimating stratum-specific densities when using a pooled detection function <span class="citation" data-cites="Buckland2015">(<a href="#ref-Buckland2015" role="doc-biblioref">Buckland et al., 2015</a>, Sect. 2.3.1)</span>. Therefore, if the purpose of the study is to produce stratum-specific density estimates, sufficient effort must be allocated per stratum to support stratum-specific detection functions. It might be the case that multiple strata share the same detection function, but reliance upon luck for that to occur is not the basis for sound inference. Sufficient detections should be made in each stratum to assess whether strata share a common detection function.</p>
<p>This simulation study evaluates the magnitude of bias in stratum-specific density estimates when strata differ in the scale parameter of their detection functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsims)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: dssd</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.1, GDAL 3.10.2, PROJ 9.5.1; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at C:/Users/erexs/Documents/GitHub/Oct-Quarto</code></pre>
</div>
</div>
</section>
<section id="study-area" class="level1">
<h1>Study area</h1>
<p>The only interesting feature of the study area used in this simulation is that it possesses two strata. We could have employed more strata, but demonstration of the phenomenon is sufficient with only two strata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>myshapefilelocation <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"shapefiles"</span>, <span class="st">"StrataPrj.shp"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>northsea <span class="ot">&lt;-</span> <span class="fu">make.region</span>(<span class="at">region.name =</span> <span class="st">"minkes"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape =</span> myshapefilelocation,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">strata.name =</span> <span class="fu">c</span>(<span class="st">"South"</span>, <span class="st">"North"</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">units =</span> <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="north-sea-study-area" class="level2">
<h2 class="anchored" data-anchor-id="north-sea-study-area">North Sea study area</h2>
<p>Interest is in estimating the density of minke whales in the western portion of the North Sea, off the east coast of Britain. The study area is divided into north and south strata, with the north stratum being roughly 1.9 times the size of the south stratum, as shown in the map below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.OceanBasemap)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> m <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="fl">1.4</span>, <span class="fl">55.5</span>, <span class="at">zoom=</span><span class="dv">5</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>minkes <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(myshapefilelocation)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>study.area.trans <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(minkes, <span class="st">'+proj=longlat +datum=WGS84'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">addPolygons</span>(m, <span class="at">data=</span>study.area.trans<span class="sc">$</span>geometry, <span class="at">weight=</span><span class="dv">2</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-41bc73abd36929e9d086" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-41bc73abd36929e9d086">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.OceanBasemap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolygons","args":[[[[{"lng":[-0.5515409453160062,3.409349728707959,3.456554576619323,4.370524186553713,4.312833536633121,4.205187536532861,2.710340660140702,1.249418158780088,1.181957158717268,1.166339908702725,1.122752033662124,1.035417283580785,1.028130908574013,0.9781629085274804,0.9590722835096983,0.9503104085015365,0.9443900334960065,0.9430505334947842,0.9522004085033021,0.9737525335233672,1.008242783555488,0.9879997835366229,0.9738511585234451,0.9623325335127225,0.9567124085074854,0.9401012834920269,0.9316615334841749,0.9080567834621722,0.8984362834532081,0.8868307834424062,0.8745489084309671,0.8656089084226438,0.8605011584178904,0.8573067834149133,0.8505820334086424,0.8458210334042067,0.8430275334016246,0.8357095333948057,0.8392759083981217,0.8340434083932566,0.8420260334006858,0.8374524083964162,0.8310900333904955,0.8303356583897998,0.833501408392749,0.8316904083910684,0.8164386583768537,0.8131767833738195,0.7991871583607806,0.7948619083567511,0.7602360333245033,0.7525402833173589,0.7385024083042712,0.7358635333018243,0.7348474083008799,0.7394119083051298,0.7304666582967908,0.7181271582852848,0.721409533288352,0.7334077832995264,0.7242639082910219,0.717686283284877,0.7095702832773161,0.707704033275576,0.7233682832901708,0.7330656582992107,0.732635783298804,0.7211341582880948,0.6779810332479033,0.6502059082220344,0.6450571582172417,0.650325783222144,0.6571722832285334,0.6649594082357736,0.6624221582334262,0.6658875332366564,0.6736792832438995,0.6935050332623693,0.6878031582570545,0.6852771582547067,0.6803197832500988,0.6748742832450032,0.6711511582415427,0.6630425332340056,0.6620940332331037,0.6656816582364512,0.6613090332323851,0.6572797832286315,0.6491941582210928,0.6349167832078136,0.6342895332072093,0.6569097832282866,0.6567870332281697,0.6467305332188004,0.6155599081897665,0.6061726581810377,0.5979614081733761,0.587735283163852,0.5737691581508387,0.5716487831488736,0.5558795331342028,0.5518461581304455,0.5512387831298613,0.5505844081292545,0.5462597831252368,0.537814033117371,0.5267054081070341,0.5255356581059238,0.5216727831023323,0.5180174080989277,0.5061619080878756,0.4785910330622019,0.4727714080567867,0.4616591580464446,0.4544059080396892,0.4453860330312978,0.4403979080266539,0.4380894080244955,0.4350396580216515,0.4299294080169034,0.4290014080160348,0.3878516579777061,0.3674640329587078,0.3613794079530523,0.3549595329470775,0.3520105329443198,0.3553051579473843,0.3377015329309928,0.3124970329075151,0.3057687829012536,0.2787422828760949,0.2458767828454709,0.2190834078205338,0.1985319078013958,0.1953121577983836,0.1801795327842795,0.1787092827829328,0.1707311577754922,0.1601140327656198,0.1574866577631722,0.1539957827599212,0.139487032746388,0.13597428274312,0.1254839077333543,0.1246669077326031,0.11302378272174,0.09071153270096487,0.07850490768959147,0.04914340766225692,0.04153953265517904,0.03645390765044048,0.03265990764691642,0.03132853264565887,0.01660653263195392,0.009229407625070893,0.01125140762695723,0.01698478263230651,0.01242940762807629,0.01419553262971343,0.01722053263253536,0.02232815763727543,0.05659915766921152,0.05712278266969403,0.05277590766564772,0.06052115767286636,0.06618278267811245,0.07342540768487953,0.08644828269700669,0.1039934077133468,0.1050644077143378,0.1166086577250955,0.1171910327256286,0.1269849077347661,0.1430740327497232,0.1520222827580824,0.1666074077716642,0.1698902827747016,0.1731191577777054,0.1765439077809109,0.1906096577939989,0.1939427827971089,0.1986014078014476,0.2023145328049056,0.216976532818563,0.223133282824307,0.2267764078276853,0.2385651578386787,0.243155907842947,0.2610515328596247,0.2658795328641194,0.2708844078687777,0.2777740328751861,0.2921719078885872,0.2932220328895596,0.2966750328927787,0.3027860328984671,0.3047617829003287,0.3180487829126831,0.3273989079214063,0.3299474079237828,0.3355714079290238,0.3388355329320518,0.3381029079313581,0.3417300329347482,0.342816532935757,0.3364847829298583,0.3290544079229388,0.3258666579199883,0.3067137829021363,0.2891810328858072,0.2767092828741796,0.268240407866301,0.2604339078590385,0.2446346578443296,0.2222750328234895,0.2190162828204624,0.223311032824455,0.2184106578199023,0.2123992828142887,0.2115234078134733,0.2159916578176535,0.2131489078149973,0.213857907815651,0.2044282828068736,0.1990634078018729,0.1977837828006844,0.1933144077965211,0.1967532827997331,0.1904326577938494,0.1971939078001407,0.1926495327959119,0.1837655327876463,0.179543657783711,0.1715372827762569,0.17224328277689,0.1761031577804885,0.1837664077876299,0.1847596577885611,0.1775542827818418,0.1717455327764414,0.1691841577740544,0.1672529077722514,0.1749547827794229,0.1746874077791748,0.1660847827711794,0.1683766577733082,0.1575304077632041,0.1448672827514204,0.1411317827479197,0.1438676577504623,0.1475211577538853,0.1492226577554733,0.1351609077423744,0.1337155327410076,0.130329407737861,0.1271167827348733,0.131294157738779,0.1298820327374411,0.1237041577317086,0.1116694077204841,0.1136869077223538,0.1212949077294639,0.1184222827267833,0.110954657719816,0.104429657713751,0.09592665770583142,0.09282778270295472,0.102012282711485,0.09715903270696866,0.09021428270051507,0.08274765769354529,0.07818228268931209,0.07168840768323985,0.06243540767462722,0.05419028266695118,0.04908940766219449,0.04004165765377321,0.03864453265248349,0.02292753263785073,0.02032103263542246,0.01384715762938514,0.003307407619559021,-0.000597842384081301,-0.0122012173948748,-0.01685609239922333,-0.03777821741869064,-0.04841421742861467,-0.05591971743558587,-0.06253334244175353,-0.1317279675061797,-0.1203270924955854,-0.09057909246786287,-0.07539259245373861,-0.07150084245009243,-0.06702759244592453,-0.04165696742231246,-0.03016109241158898,-0.01222884239490411,0.001344657617749516,0.007379782623360012,0.01473165763022153,0.05466903266739104,0.06746490767932316,0.0999520327095809,0.1023984077118599,0.1224031577304742,0.1281464077358406,0.1318391577392784,0.1281840327358737,0.0921001577022762,0.09273653270284354,0.09540165770533789,0.1118901577206941,0.1366799077437691,0.1386684077456268,0.1316039077390483,0.1157170327242623,0.1066710327158376,0.09102290770127326,0.02701478264165766,0.01457228263006963,0.01074190762648206,-0.001356092384781871,-0.01225871739492842,-0.02329634240521714,-0.08029921745830376,-0.1348810925091191,-0.170712842542514,-0.1780435925493293,-0.186086967556833,-0.2161437175847995,-0.2323619675999281,-0.2348724676022587,-0.2347965926021801,-0.233884592601328,-0.2299492175976636,-0.2277990925956603,-0.2168202175854508,-0.2152935925840326,-0.2108530925798957,-0.203834217573359,-0.2009268425706526,-0.2017610925714168,-0.1821065925531111,-0.1552552175280937,-0.1380850925121136,-0.1265629675013714,-0.09595734247287231,-0.09427309247129805,-0.1066585924828583,-0.1113688424872238,-0.1516058425247026,-0.1598020925323456,-0.1789322175501697,-0.1863195925570268,-0.2310240925986592,-0.2555274676214764,-0.2776843426421182,-0.2899424676535318,-0.2963864676595449,-0.3023772176651106,-0.3012808426641131,-0.2983197176613427,-0.2928029676562006,-0.2870814676508646,-0.2827665926468518,-0.2833930926474294,-0.2953585926585734,-0.3282697176892388,-0.3315225926922665,-0.3349868426954855,-0.3456985927054744,-0.3592553427180861,-0.3671599677254563,-0.3854135927424525,-0.3871314677440694,-0.3831378427403253,-0.3829724677401891,-0.3924833427490462,-0.3929027177494217,-0.4021242177580288,-0.4096422177650251,-0.409852967765204,-0.4160555927709877,-0.4150155927700327,-0.4057228427613785,-0.4031377177589661,-0.4053630927610352,-0.4152754677702715,-0.4224733427769821,-0.4293314677833563,-0.4261800927804131,-0.4348770927885262,-0.438731842792123,-0.4360510927896255,-0.4389310927923018,-0.4362164677897622,-0.4384802177918911,-0.4432654677963226,-0.4506824678032333,-0.4486213428013175,-0.4561788428083567,-0.464968592816547,-0.4657688053647076,-0.4668219678182776,-0.473909342824868,-0.4882354678382231,-0.5101205928586121,-0.5227123428703351,-0.5230224678706179,-0.5244949678719879,-0.5356795928823888,-0.5482117178940769,-0.5517502178973642,-0.5515409453160062],"lat":[54.43275497393265,55.47755684463978,55.37672135800187,53.42436742683314,53.41194381162109,52.86587868583872,52.92983431093081,52.96397781097988,52.94847693595761,52.94779981095658,52.95152281096195,52.96662881098369,52.9678870609855,52.98002056100291,52.98255181100657,52.98218493600605,52.97988743600278,52.97788131099987,52.97457418599513,52.97767006099959,52.96876231098674,52.96480043598105,52.96737806098477,52.96597306098271,52.96663656098369,52.96358706097934,52.96640918598334,52.96543806098187,52.96784018598544,52.96551606098208,52.96931793598753,52.96948118598777,52.97243368599199,52.97786143599981,52.98074081100392,52.98089331100417,52.97509106099582,52.97134443599047,52.96942568598775,52.96373031097957,52.96106393597569,52.9600075609742,52.96126493597595,52.96685393598401,52.97171818599102,52.97549406099642,52.97854868600086,52.97818931100034,52.97664306099809,52.97364868599381,52.97778443599967,52.9805678110037,52.98030343600331,52.97949818600214,52.97620618599745,52.97416956099452,52.96785168598544,52.96965156098806,52.97227993599179,52.97483693599556,52.9783531860005,52.97697956099861,52.97699381099857,52.97788556099984,52.98089706100421,52.97918893600171,52.98263393600669,52.98531781101057,52.99023193601762,52.99091531101856,52.98971381101688,52.9872193110133,52.98947093601652,52.98884568601556,52.9820814360059,52.98071281100392,52.98526843601047,52.98192831100568,52.97778481099976,52.97765156099958,52.97945106100209,52.98142656100496,52.97812731100019,52.97657756099799,52.97455143599507,52.97236981099194,52.97093131098985,52.97174393599104,52.97041918598911,52.97182193599117,52.97321381099316,52.97587093599696,52.97861793600091,52.98055806100373,52.97567318599666,52.97667931099814,52.97398156099424,52.9782105610003,52.97890731100135,52.97646206099782,52.97401968599426,52.97552531099648,52.97686418599839,52.97831018600048,52.97662381099804,52.97964806100242,52.9784149360006,52.97388281099408,52.97309656099303,52.97458818599509,52.96926506098747,52.95348556096484,52.94773606095648,52.92935993593012,52.90742831089851,52.89538456088118,52.8916380608758,52.88990581087331,52.88109356086058,52.87463106085129,52.84701306081151,52.83462618579368,52.82179131077519,52.81261681076192,52.80825218575565,52.80034793574427,52.79041418572993,52.80080068574494,52.81073531075923,52.81597268576683,52.81795718576964,52.8089211857566,52.81819568576999,52.82087981077385,52.82760456078357,52.84565406080959,52.85072793581687,52.85942118582938,52.86362331083548,52.87307206084905,52.87660468585416,52.87955243585841,52.88285506086316,52.88407906086493,52.88798893587052,52.88902093587199,52.89379193587889,52.89255081087711,52.89912106088655,52.89865431088589,52.90131693588973,52.90119856088954,52.89872643588603,52.8991480608866,52.89643081088267,52.90824018589972,52.91353006090734,52.91511993590959,52.92543556092442,52.92608806092537,52.92365856092191,52.93088668593229,52.93269881093489,52.93990731094524,52.94676306095506,52.95596456096835,52.9612343109759,52.9770734359987,52.98774906101404,52.99160218601958,52.99834318602927,53.00083831103288,53.00465718603832,53.01583268605437,53.01853343605832,53.02975081107439,53.03010918607491,53.03046843607538,53.03516068608214,53.03999106108906,53.04354731109417,53.04477581109595,53.04832006110103,53.0556414361115,53.0565960611129,53.06379831112328,53.06846443612995,53.07334781113691,53.07828256114403,53.08590093615493,53.08666043615606,53.09170406116328,53.09560031116884,53.09899543617372,53.0993428111742,53.09526931116836,53.09611956116959,53.09593768616937,53.10295356117936,53.1280058112153,53.1358263112265,53.14714868624277,53.1649935612683,53.17607193628413,53.1929439363083,53.2040214363242,53.21701368634278,53.23916543637444,53.27357168642363,53.29604706145572,53.30647893647063,53.3213670614919,53.33507643651143,53.35154593653494,53.381004811577,53.38773056158656,53.38874193658803,53.39414243659574,53.39546593659764,53.3986888116022,53.40175331160656,53.40434993661029,53.4082150616158,53.41443518662464,53.41436668662451,53.41280956162232,53.41431218662444,53.41877543663081,53.421021936634,53.42401756163833,53.42917806164564,53.43287031165092,53.43276693665076,53.43780118665794,53.44166518666341,53.4420055616639,53.43744031165744,53.44014843666124,53.44561868666903,53.44487718666802,53.44632293667005,53.45072181167632,53.451176436677,53.45255643667891,53.45509668668252,53.45959481168897,53.47202181170662,53.47650668671304,53.48232731172136,53.48293056172222,53.48076793671911,53.48277406172199,53.49354581173726,53.49465168673883,53.49543331173996,53.49370206173748,53.48855643673019,53.48539731172569,53.48489668672499,53.48776068672903,53.49363981173745,53.49752756174294,53.49989631174627,53.50239756174989,53.50235893674981,53.50626018675541,53.50589393675488,53.49626281174115,53.49320731173683,53.49272568673613,53.49522293673964,53.50038056174701,53.49600093674073,53.50015006174668,53.51203631176363,53.51538081176832,53.51860706177289,53.51910293677361,53.51932343677395,53.52510918678219,53.52095456177629,53.52353668677993,53.5323253117924,53.54145218680538,53.54511481181058,53.55734581182796,53.56860593684403,53.5708671868472,53.57496168685298,53.64209056194829,53.63748918694178,53.6335019369361,53.6314623119332,53.63203868693404,53.63511318693837,53.63965943694485,53.64390656195087,53.64626118695418,53.64804443695677,53.6512989369613,53.65177568696199,53.64584431195362,53.64227856194854,53.63015056193134,53.62880881192943,53.61785056191393,53.61288406190688,53.60638443689765,53.59941118688778,53.57671381185551,53.57509681185321,53.57478806185277,53.5836736868654,53.59984693688836,53.60527106189601,53.61863343691503,53.64864593695759,53.66032618697415,53.67608268699649,53.72629381206762,53.73603868708145,53.74116931208869,53.74904518709983,53.75899318711387,53.76906706212818,53.81494081219306,53.86368381226195,53.90093843731448,53.91140581232932,53.92782706235242,53.97609931242045,54.0182956874799,54.03136856249829,54.03198656249913,54.03933356250947,54.04516693751769,54.06336718754331,54.07494918755961,54.07970231256624,54.08186968756928,54.08214131256967,54.08457556257306,54.08893556257924,54.10188431259743,54.1071058126048,54.10637443760377,54.10588343760307,54.1141873126147,54.12076043762394,54.12657231263213,54.13103481263843,54.13919118764981,54.1439744376566,54.14835968766273,54.15357693766999,54.15976781267869,54.16542256268664,54.17649156270213,54.1845614377135,54.19225581272435,54.20610218774373,54.21565831275713,54.21877856276146,54.21955006276256,54.21780768776008,54.21815506276064,54.22022193776349,54.22189981276586,54.23048681277788,54.23399256278279,54.23486218778405,54.2375431877878,54.24427093779722,54.24287018779525,54.24948256280449,54.25272143780901,54.25399168781083,54.25626981281398,54.25969793781886,54.26472981282588,54.26678093782873,54.27084331283446,54.27336031283795,54.27944468784649,54.28306881285154,54.2874066878576,54.29076393786227,54.29241568786462,54.29037781286178,54.29352006286616,54.30144243787725,54.30729881288547,54.3113909378912,54.31764256289993,54.32236981290649,54.32586356291146,54.33104381291865,54.33771556292802,54.34193818793391,54.34211643793413,54.34913968794399,54.35844693795694,54.36139918796111,54.366835797583,54.37399093797872,54.3789493129856,54.39799893801223,54.40992493802889,54.40908081302772,54.40952381302829,54.41163268803129,54.41417656303476,54.42564543805083,54.43120306305854,54.43275497393265]}]],[[{"lng":[3.409349728707959,-0.5515409453160062,-0.5509528428966344,-0.540622967887004,-0.5398863428863198,-0.5532587178987848,-0.5621577179070698,-0.5732955929174471,-0.5822359679257542,-0.5882569679313577,-0.6048569679468301,-0.6084682179501893,-0.6144069679557161,-0.6244267179650645,-0.6328539679728925,-0.6326865929727602,-0.6519320929906771,-0.6752977180124448,-0.6921124680280849,-0.6931689680290848,-0.6891145930252947,-0.6897352180258731,-0.7040567180392261,-0.7130318430475885,-0.7236743430574962,-0.7257335930594024,-0.7295390930629532,-0.7334909680666329,-0.7372410930701108,-0.7407422180733931,-0.7503603430823486,-0.7590042180903825,-0.7689264680996364,-0.7659344680968437,-0.7698592181004924,-0.7782967181083508,-0.7837979681134758,-0.7873197181167478,-0.7926992181217828,-0.7924413431215388,-0.8034313431317628,-0.8112949681390944,-0.8165185931439682,-0.8273614681540662,-0.8562419681809385,-0.866352343190357,-0.878889468202033,-0.8884658432109518,-0.9004994682221648,-0.9134305932342104,-0.9144164682351178,-0.9184120932388569,-0.9333877182527895,-0.9347814682541014,-0.943260218261998,-0.9545984682725648,-0.9677088432847545,-0.9834207182993848,-1.015616718329369,-1.046424718358081,-1.062879843373396,-1.053353218364521,-1.06961596837968,-1.079889968389239,-1.108006968415424,-1.119931968426527,-1.122113593428565,-1.125515718431728,-1.124804968431079,-1.132235343437998,-1.136689593442128,-1.136841968442269,-1.138672968443984,-1.139166968444443,-1.140465343445641,-1.196386843497735,-1.195248968496671,-1.19402496849554,-1.197447968498722,-1.186344968488384,-1.180245968482695,-1.177564968480198,-1.181200968483581,-1.20012296850122,-1.218743968518552,-1.231996218530896,-1.307999718601678,-1.308061968601735,-1.308475968602125,-1.31217896860558,-1.3107049686042,-1.31350396860681,-1.319092968612012,-1.326592968618997,-1.346056968637129,-1.345328968636451,-1.352861968643467,-1.352755968643365,-1.360902968650947,-1.360119968650224,-1.352244968642893,-1.351441968642135,-1.358340968648563,-1.352497968643122,-1.360657968650727,-1.366674968656326,-1.362597968652537,-1.354852968645318,-1.353796968644332,-1.35680496864714,-1.364586968654379,-1.366760968656408,-1.380662968669357,-1.378895968667706,-1.383485968671977,-1.39257496868045,-1.403004968690169,-1.408735968695496,-1.412181968698704,-1.412634968699138,-1.420962968706888,-1.424380968710068,-1.438342968723078,-1.440155968724767,-1.440644968725224,-1.441872968726359,-1.448699968732726,-1.459077968742378,-1.459261968742553,-1.461276968744429,-1.46436296874731,-1.467975968750665,-1.475782968757941,-1.455278968738853,-1.447953968732022,-1.447927968732004,-1.440272968724871,-1.431081968716313,-1.426972968712491,-1.418658968704748,-1.413784968700198,-1.419252968705294,-1.419539968705564,-1.428327968713745,-1.432507968717644,-1.444502968728813,-1.449039968733033,-1.454453968738079,-1.450968968734828,-1.4576929687411,-1.463596968746586,-1.469504968752091,-1.470148968752696,-1.475273968757464,-1.484128968765717,-1.496308968777057,-1.498676968779264,-1.497302968777987,-1.49070996877184,-1.500245968780732,-1.508719968788612,-1.51681296879616,-1.524636968803436,-1.53631696881432,-1.541418968819074,-1.520820968799882,-1.514108968793636,-1.501614968781994,-1.49961196878013,-1.50607596878615,-1.519373968798533,-1.526369968805058,-1.56210396883833,-1.574309968849705,-1.571867968847429,-1.553981968830769,-1.541837968819465,-1.529702968808153,-1.528213968806768,-1.523789968802646,-1.520307968799415,-1.514937968794414,-1.515984968795379,-1.509541968789378,-1.501632968782019,-1.504984968785139,-1.502294968782635,-1.513308968792885,-1.525517968804266,-1.529557968808021,-1.527204968805834,-1.538407968816273,-1.548226968825418,-1.55735896883391,-1.5710869688467,-1.572248968847788,-1.568844968844617,-1.562274968838494,-1.560826968837148,-1.550447968827484,-1.548114968825303,-1.571782968847345,-1.587486968861981,-1.588583968862992,-1.600800968874383,-1.607430968880551,-1.60419896887754,-1.601058968874611,-1.600729968874306,-1.591958968866138,-1.587219968861731,-1.586727968861268,-1.603559968876937,-1.602175968875657,-1.611712968884533,-1.617820968890229,-1.620182968892423,-1.621122968893304,-1.61437496888702,-1.609918968882866,-1.596754968870613,-1.594527968868535,-1.589144968863523,-1.581521968856421,-1.581529968856429,-1.578290968853409,-1.587379968861882,-1.594320968868345,-1.589220968863586,-1.589015968863393,-1.594293968868315,-1.589695968864035,-1.594553968868553,-1.595061968869033,-1.595255968869211,-1.592036968866211,-1.610373968883295,-1.618915968891244,-1.615540968888098,-1.616090968888614,-1.619533968891816,-1.611616968884448,-1.620746968892946,-1.620996968893181,-1.630531968902063,-1.636249968907393,-1.640972968911783,-1.633616968904932,-1.626369968898189,-1.62467096889661,-1.639027968909971,-1.644642968915208,-1.642367968913092,-1.63886996890983,-1.645569968916064,-1.645027968915571,-1.662233968931588,-1.697582968964511,-1.709489968975604,-1.719902968985296,-1.728197968993016,-1.734660968999038,-1.743427969007201,-1.747090969010616,-1.751278969014522,-1.760616969023219,-1.762816969025267,-1.769821969031782,-1.7763879690379,-1.785072969045985,-1.782993969044057,-1.774563969036209,-1.77246196903424,-1.76913196903115,-1.761797969024315,-1.75525696901822,-1.751604969014821,-1.775835969037388,-1.779500844040798,-1.779511469040812,-1.785063969045979,-1.787507969048265,-1.792253969052681,-1.795515969055715,-1.793088969053458,-1.802211969061957,-1.803520969063173,-1.803513594063162,-1.805224969064753,-1.812971969071968,-1.830244719088057,-1.826715844084775,-1.830236094088051,-1.834139969091695,-1.843247969100177,-1.843079969100017,-1.856142969112185,-1.857426969113377,-1.859005469114848,-1.863117969118676,-1.871436969126421,-1.870129969125203,-1.876145969130804,-1.87526196912998,-1.88242696913666,-1.88264796913687,-1.887667969141547,-1.902032969154917,-1.905132969157805,-1.913170969165293,-1.924142969175507,-1.943683969193714,-1.984216969231455,-1.995321969241801,-1.99985896924602,-1.99896096924519,-2.002924969248882,-2.003627969249536,-2.007949969253559,-2.019115969263964,-2.025349969269769,-2.034505969278301,-2.040781969284141,-2.053415969295899,-2.05726647547567,-2.057266475021483,-2.05938197446585,-2.071268974476908,-2.07629697448158,-2.07569297448103,-2.07848297448362,-2.076999974482248,-2.081603974486542,-2.085977974490618,-2.092959974497119,-2.098843974502587,-2.109450974512471,-2.131503974533018,-2.132161974533632,-2.133383974534752,-2.139746974540687,-2.13345897453482,-2.141062974541911,-2.136469974537649,-2.136779974537918,-2.147080974547521,-2.152775974552812,-2.157354974557081,-2.175569974574047,-2.193652974590889,-2.206576974602938,-2.218936974614423,-2.22986297462461,-2.247343974640899,-2.252321974645528,-2.262554974655046,-2.284355974675349,-2.285675974676595,-2.292510974682955,-2.305054974694627,-2.309056974698367,-2.327747974715778,-2.341111974728221,-2.343822974730755,-2.358383974744301,-2.35995897474578,-2.39094997477463,-2.404565974787316,-2.406032974788672,-2.413636974795764,-2.423747974805195,-2.449117974828795,-2.450615974830216,-2.453810974833176,-2.455046974834317,-2.45753097483666,-2.461150974840025,-2.468906974847243,-2.476163974853991,-2.477257974855009,-2.485725974862901,-2.495531974872022,-2.511700974887106,-2.518947974893849,-2.52006297489487,-2.544881974917985,-2.551840974924487,-2.550359974923112,-2.557291974929544,-2.580661974951313,-2.584742974955106,-2.591398974961323,-2.602032974971223,-2.60687397497574,-2.612804974981258,-2.603843974972903,-2.603341974972438,-2.597409974966923,-2.597372974966873,-2.591376974961292,-2.594919974964597,-2.599424974968799,-2.601881974971094,-2.60509697497409,-2.619170974987186,-2.619493974987478,-2.632293974999414,-2.650099975015993,-2.656202975021669,-2.661018975026167,-2.665475975030319,-2.678117975042086,-2.688250975051517,-2.702521975064799,-2.707449975069408,-2.717219975078493,-2.726093975086771,-2.728194975088726,-2.752992975111809,-2.757515975116024,-2.764039975122103,-2.777817975134937,-2.779695975136692,-2.78393797514063,-2.793260975149324,-2.79981797515542,-2.805069975160323,-2.812871975167581,-2.815694975170218,-2.82305697517707,-2.830930975184402,-2.838290975191255,-2.839590975192467,-2.851894975203919,-2.853863725205756,-2.872049350222696,-2.870961975221676,-2.860702975212121,-2.855809975207566,-2.848121975200414,-2.84362497519622,-2.838657975191593,-2.837083975190128,-2.830053975183588,-2.81625197517073,-2.806310975161467,-2.79559997515149,-2.756178975114779,-2.718454975079652,-2.70974597507154,-2.699527975062014,-2.691711975054747,-2.682117975045796,-2.666514975031276,-2.657120975022538,-2.652049975017804,-2.64746897501354,-2.638798975005471,-2.638344975005054,-2.628788974996128,-2.614022974982391,-2.60116197497041,-2.596071974965668,-2.610670974979258,-2.622532974990322,-2.627778974995208,-2.637561975004305,-2.641166975007682,-2.649318975015264,-2.665902975030719,-2.667413975032104,-2.680053975043876,-2.687879975051175,-2.691970975054971,-2.697892975060512,-2.70884897507071,-2.716032975077399,-2.719667975080784,-2.730375975090752,-2.746331975105605,-2.757337975115861,-2.78355897514028,-2.78960397514591,-2.797329975153105,-2.813698975168352,-2.81239997516714,-2.816358975170828,-2.826905975180651,-2.83364197518692,-2.841067975193837,-2.843139975195769,-2.858229975209825,-2.868824975219696,-2.886496975236157,-2.893453975242638,-2.893834100242983,-2.894352225243469,-2.874914975225366,-2.865818975216897,-2.857900975209517,-2.845994975198423,-2.846141975198563,-2.843268975195896,-2.832497975185859,-2.824082975178017,-2.817023975171452,-2.815688975170206,-2.817641975172024,-2.813436975168103,-2.814575975169163,-2.811634975166429,-2.808507975163523,-2.819082975173358,-2.820228975174432,-2.823232975177234,-2.860731975212162,-2.871396975222086,-2.886043975235725,-2.891742100241034,-2.882277350232216,-2.87683797522716,-2.842123975194824,-2.841691975194424,-2.830536975184032,-2.794693975150651,-2.793091975149153,-2.772601975130073,-2.76445497512249,-2.747667975106849,-2.738574975098388,-2.733976975094111,-2.725893975086577,-2.726544975087178,-2.716136975077491,-2.692137975055148,-2.683425975047017,-2.667993975032657,-2.643517975009872,-2.63256497499967,-2.620429974988355,-2.608381974977136,-2.60016497496949,-2.592730974962564,-2.589781974959805,-2.57232197494355,-2.562023974933965,-2.546608974919593,-2.549331974922154,-2.544346974917487,-2.543887974917085,-2.535654974909395,-2.529401974903578,-2.530974974905038,-2.52679097490116,-2.527061974901388,-2.523687974898251,-2.514967974890141,-2.499711974875936,-2.489247974866176,-2.490322974867183,-2.500572974876719,-2.509273974884819,-2.51457897488979,-2.51658497489163,-2.512012974887397,-2.509764974885285,-2.4967769748732,-2.495861974872355,-2.485934974863084,-2.47893897485659,-2.47177697484992,-2.460968974839859,-2.447864974827638,-2.453173974832596,-2.44432697482435,-2.445929974825845,-2.471986974850098,-2.476570974854382,-2.488040974865072,-2.490638974867467,-2.519246974894117,-2.525845974900281,-2.542587974915846,-2.558176974930377,-2.554027974926529,-2.543751974916945,-2.542064974915376,-2.545319974918417,-2.544455974917613,-2.538292974911855,-2.537475974911104,-2.538003974911592,-2.533859974907728,-2.527530974901851,-2.528248974902509,-2.525722974900163,-2.518669974893584,-2.495561974872061,-2.488071974865079,-2.48316497486053,-2.481663974859115,-2.485486974862682,-2.468239974846626,-2.463240974841967,-2.457782974836874,-2.455004974834282,-2.446717974826585,-2.435853974816469,-2.436456974817021,-2.443301974823386,-2.425357974806671,-2.424588974805971,-2.421913974803461,-2.408461974790954,-2.397624974780855,-2.386084974770112,-2.383572974767761,-2.383048974767293,-2.376727974761395,-2.370477974755572,-2.367488974752775,-2.339908974727109,-2.330254974718116,-2.313741974702741,-2.297056974687194,-2.285361974676306,-2.279838974671152,-2.282056974673225,-2.269551974661569,-2.263228974655676,-2.259743974652451,-2.252948974646103,-2.243674974637486,-2.242453974636335,-2.221446974616782,-2.223195974618394,-2.216796974612437,-2.208832974605031,-2.212081974608053,-2.210290974606381,-2.203184974599763,-2.203401974599956,-2.207699974603968,-2.203783974600328,-2.206985974603298,-2.206398974602764,-2.202588974599224,-2.205373974601798,-2.202825974599422,-2.20729897460359,-2.203106974599706,-2.207974974604241,-2.203301974599869,-2.208262974604506,-2.208607974604803,-2.211896974607868,-2.211783974607785,-2.210441974606511,-2.194318974591511,-2.18513897458297,-2.18653097458426,-2.183359974581292,-2.175338974573832,-2.175916974574365,-2.170386974569227,-2.168863974567814,-2.162080974561492,-2.160017974559567,-2.154051974553994,-2.149173974549457,-2.14035997454127,-2.126659974528508,-2.13156197453307,-2.119784974522108,-2.117992974520433,-2.111407974514294,-2.109010974512045,-2.110596974513527,-2.101287974504857,-2.09820197450199,-2.101016974504605,-2.095904974499861,-2.097079974500957,-2.086773974491337,-2.087901974492411,-2.078087974483254,-2.078741974483876,-2.069814974475548,-2.070957974476612,-2.064568974470661,-2.064393974470505,-2.061016974467349,-2.054054974460882,-2.054785974461567,-2.063038974469237,-2.060843974467188,-2.052864974459765,-2.050692974457747,-2.057337974463936,-2.061818974468111,-2.081259974486215,-2.087937974492435,-2.086130974490743,-2.082752974487621,-2.077810974483015,-2.074842974480247,-2.08126197448621,-2.083883974488658,-2.082511974487375,-2.092994974497146,-2.095420974499405,-2.09208697449631,-2.081950974486859,-2.07360597447908,-2.069248974475017,-2.059269974465735,-2.034099974442285,-2.010071974419928,-1.996099974406917,-1.996343974407126,-1.999956974410509,-1.996973974407723,-1.996788974407537,-2.00176497441217,-2.000564974411049,-2.005491974415663,-2.016749974426147,-2.013137974422762,-2.000347974410857,-2.009952974419803,-2.015320974424811,-2.016449974425855,-2.023013974431961,-2.016291974425713,-2.012226974421937,-2.003435974413748,-2.001251974411703,-1.994729974405629,-1.993981974404932,-2.002305974412679,-1.988805974400124,-1.990663974401828,-1.994502974405408,-1.99372197440468,-1.988217974399561,-1.972898974385289,-1.959320974372645,-1.959156974372491,-1.939552974354229,-1.937785974352606,-1.930291974345609,-1.928629974344062,-1.925879974341513,-1.925065974340754,-1.916135974332435,-1.915948974332252,-1.91497097433134,-1.897911974315464,-1.895861974313561,-1.890319974308398,-1.89017597430825,-1.880369974299129,-1.868648974288192,-1.862709974282665,-1.866754974286436,-1.866368974286076,-1.86234097428232,-1.852486974273149,-1.842535974263881,-1.834355974256254,-1.833279974255277,-1.828569974250884,-1.826772974249197,-1.818222974241252,-1.822480974245194,-1.811418974234898,-1.811256974234767,-1.803594974227623,-1.800844974225073,-1.803249974227302,-1.785165974210458,-1.782738974208201,-1.776362974202246,-1.775450974201419,-1.78749097421263,-1.79191997421674,-1.796561974221077,-1.800665974224899,-1.786528974211735,-1.786019974211257,-1.794344974219002,-1.797587974222011,-1.793519974218241,-1.777564974203387,-1.778505974204251,-1.77560997420156,-1.770015974196353,-1.771833974198046,-1.777763974203566,-1.777195974203039,-1.796320974220834,-1.803509974227552,-1.802867974226926,-1.809396974233012,-1.811213974234705,-1.810111974233678,-1.805310974229229,-1.808570974232254,-1.821372974244186,-1.825743250134299,-1.825354670712524,-1.825112974247645,-1.825344734930056,-1.816897841389717,2.074618645579438,3.409349728707959],"lat":[55.47755684463978,54.43275497393265,54.43711618806683,54.44486118807767,54.44986218808457,54.45496493809171,54.46247218810221,54.465919188107,54.47867431312478,54.48246168813008,54.4864891881357,54.49113481314212,54.49035631314108,54.49309431314487,54.49031956314101,54.49282256314449,54.49850081315242,54.50130668815635,54.50829318816605,54.51013906316865,54.51210443817139,54.51462631317489,54.52383706318772,54.52471718818893,54.53019818819657,54.53480206320302,54.53670968820562,54.53633931320513,54.53300093820046,54.53353468820126,54.53054668819704,54.530503938197,54.53505406320332,54.53886531320862,54.54510893821734,54.54708418822008,54.5483696882219,54.55483131323088,54.55676881323359,54.56086981323932,54.56110481323962,54.56338906324275,54.56198468824081,54.56183568824058,54.57155993825414,54.57336306325669,54.57407981325767,54.57176693825441,54.57429481325795,54.57501068825891,54.57822656326341,54.57716618826194,54.58316881327026,54.58616268827446,54.58906893827847,54.59020481328005,54.58796068827698,54.58826818827738,54.59596718828808,54.60750743830411,54.61791743831859,54.61939106332069,54.62397806332702,54.62326006332602,54.62720906333153,54.63222106333848,54.63256106333895,54.63527581334274,54.63664206334462,54.64063793835013,54.64419243835515,54.6500360633632,54.65019606336343,54.64937206336232,54.64720543835929,54.69183018842125,54.69203906342154,54.69372906342387,54.70037806343308,54.69376406342394,54.69278306342257,54.69556406342644,54.70021406343291,54.70801206344369,54.71381806345172,54.72024593846065,54.78089593854472,54.78171906354587,54.78718906355344,54.79203806356014,54.79771406356803,54.81258006358862,54.81928306359792,54.83514006361982,54.85712106365023,54.86372006365934,54.87136806366989,54.88139306368377,54.89269606369938,54.90043606371012,54.9053150637168,54.90774906372019,54.91191506372594,54.91672506373262,54.92141306373908,54.93587106375907,54.94606006377314,54.95026406377887,54.95549006378612,54.96670506380157,54.96979906380584,54.97393806381156,54.98168606382224,54.98530206382728,54.98879606383206,54.9896280638332,54.99549506384125,55.00000006384747,55.00270806385118,55.00538306385491,55.00526006385476,55.00917806386018,55.00684706385697,55.00145306384949,55.00000006384747,54.99634606384247,54.98642706382873,54.98522206382713,54.98135006382179,54.98069806382086,54.98257106382352,54.98171606382229,54.98929206383276,54.98994806383363,54.99370606383883,55.00000006384747,55.00824006385881,55.01017406386156,55.01399606386676,55.01523606386849,55.01868806387323,55.02059906387591,55.02288106387902,55.03008706388896,55.04223306390569,55.04903006391503,55.05389006392171,55.06536906393755,55.07169306394626,55.07248306394732,55.07973906395731,55.08337806396229,55.08657806396671,55.08757006396807,55.09386106397675,55.10567106399298,55.11459406400527,55.11844606401056,55.11840406401051,55.12951306402579,55.13083606402758,55.13560906403413,55.13868706403839,55.13590206403455,55.13757306403682,55.14364206404517,55.13745106403666,55.13114906402804,55.13158006402862,55.13521606403357,55.14909006405264,55.16149906406972,55.16454306407387,55.16791206407848,55.16901406407992,55.16783906407842,55.16422306407342,55.16701906407729,55.16471906407413,55.1655620640753,55.17189006408399,55.1759070640895,55.17911506409385,55.18661906410421,55.18755306410547,55.19261906411245,55.19895606412111,55.20231206412576,55.21434806414225,55.22192806415264,55.22963706416323,55.2377820641744,55.24134406417927,55.25127806419289,55.27449006422469,55.29296106425005,55.29746606425618,55.30124306426135,55.30669006426885,55.31496406428013,55.32222006429012,55.33851606431238,55.33976406431407,55.33876006431267,55.34304006431858,55.34700806432396,55.34764506432484,55.34623306432297,55.35204706433088,55.34382206431966,55.34238806431762,55.34442906432043,55.36198806434452,55.36606606435009,55.38579606437704,55.38360606437406,55.38454806437534,55.39048406438346,55.38902306438144,55.3900950643829,55.39765206439321,55.40263006440008,55.40642506440521,55.40654006440538,55.42408006442931,55.43359806444229,55.43669106444656,55.4429440644551,55.44924506446365,55.45380006446985,55.46139106448029,55.46542706448577,55.47346906449674,55.48154406450772,55.48463806451193,55.49370206452431,55.49692506452877,55.50365406453788,55.50724806454279,55.51295106455051,55.5168720645559,55.52313606456443,55.52577206456805,55.52919006457264,55.53183406457629,55.53897506458598,55.54131706458922,55.55305506460519,55.55318106460536,55.55520606460814,55.56725306462451,55.5768970646377,55.57811706463929,55.58000206464183,55.5832820646463,55.58646406465067,55.58898206465407,55.60996206468264,55.61422306468846,55.61573006469043,55.6197130646959,55.61934306469539,55.62173806469863,55.62087606469748,55.61706206469231,55.61536006468994,55.61083606468384,55.60705606467871,55.61397206468808,55.61841206469413,55.61998006469626,55.61918606469517,55.62101006469768,55.62389806470156,55.62585106470421,55.62268406469995,55.6230960647005,55.63742106471995,55.642597814727,55.642597814727,55.64924406473599,55.65861306474874,55.66095106475194,55.66008206475071,55.65025906473734,55.64400306472891,55.64194131472611,55.64194156472608,55.6384810647214,55.63630306471845,55.64119806472512,55.64129618972522,55.64119881472509,55.64213006472636,55.64634106473207,55.65066306473793,55.65697606474654,55.65833406474832,55.66000168975063,55.66434606475651,55.66832106476195,55.67080906476528,55.68226406478087,55.68430506478364,55.68689506478717,55.69167906479367,55.69766006480177,55.70216106480785,55.70561406481256,55.70661706481391,55.71562706482609,55.72246006483541,55.75252306487615,55.76994906489977,55.7788790649119,55.78137006491527,55.78369306491836,55.7866610649225,55.79035006492742,55.79502606493372,55.80192306494308,55.80635206494908,55.81402706495949,55.82158106496973,55.83131822359802,55.83131822359805,55.83666809719516,55.84453409720584,55.85164409721544,55.85755309722337,55.85894909722532,55.86689909723602,55.87468909724662,55.87723709725004,55.87457809724641,55.88056009725453,55.87862209725185,55.88635809726232,55.88795609726453,55.89092809726853,55.89486109727388,55.90117009728237,55.90443609728676,55.90848309729225,55.91144709729626,55.91928609730681,55.91889009730629,55.91529209730144,55.9168410973035,55.92270409731144,55.92487909731437,55.93227909732438,55.933519097326,55.93277109732502,55.92917809732021,55.9263130973163,55.92693909731714,55.92697709731721,55.92931509732037,55.93079209732235,55.93287409732518,55.93235609732445,55.93360709732617,55.93841009733267,55.94058009733559,55.94241509733802,55.95313809735254,55.96076009736282,55.9669170973711,55.9715290973773,55.97342809737989,55.98295409739275,55.98819909739981,55.99049909740287,55.98967909740181,55.98802709739957,55.98964509740174,55.98834009739998,55.99089609740345,55.99614109741049,55.99915909741457,55.99718609741189,56.00139809741757,56.00463609742192,56.00919509742813,56.00891309742769,56.00691409742502,56.00030709741612,55.99944509741495,56.00961509742869,56.00895909742779,56.0019470974183,55.99905909741445,56.00091309741701,56.00914209742803,56.01057609742995,56.01818209744017,56.01745009743922,56.02101309744402,56.02646009745133,56.02791009745329,56.02657509745148,56.02708209745217,56.02775009745311,56.03603109746425,56.04012809746975,56.05135909748486,56.05692809749237,56.05719509749271,56.06086509749768,56.06202909749921,56.06119309749811,56.06375709750149,56.06292909750048,56.06068209749743,56.06096409749781,56.06579009750431,56.06216209749942,56.06479809750298,56.06232209749964,56.06189909749909,56.06606809750465,56.0658660975044,56.06541609750376,56.06819309750757,56.06572509750423,56.06847909750793,56.06442409750244,56.06625509750496,56.06424509750222,56.0554100974903,56.0533960974876,56.04817009748061,56.04208209747239,56.04190022247213,56.18949834767052,56.18935909767034,56.19249909767457,56.19179309767361,56.18675409766687,56.1869600976671,56.19125909767287,56.19154509767329,56.19281209767494,56.18705909766725,56.1956540976788,56.20105909768603,56.21200309770071,56.2183970977093,56.22517209771832,56.22488609771801,56.22734209772126,56.23729509773464,56.24038509773873,56.24520709774526,56.24780409774871,56.25187109775418,56.25568609775931,56.25795509776232,56.26494809777163,56.26644709777371,56.2745530977845,56.28293409779582,56.28985409780502,56.29060909780604,56.29451209781128,56.29684609781437,56.30096209781986,56.30306009782272,56.31407709783748,56.32068009784629,56.32416709785093,56.3221640978483,56.32698609785471,56.32926309785773,56.32772609785575,56.32878309785715,56.33235309786189,56.32968309785828,56.33158709786085,56.3352870978658,56.33655709786755,56.34295409787608,56.34708909788161,56.34944309788474,56.3537580978905,56.36287509790266,56.37065709791309,56.35954409789821,56.35684709789465,56.35740809789535,56.36147509790087,56.36652509790754,56.36455709790497,56.36594909790674,56.36630647290728,56.37051222291287,56.37109909791368,56.37523009791918,56.37311009791639,56.37731309792199,56.37415509791777,56.37414309791772,56.38068609792646,56.39383909794404,56.39880509795069,56.40539309795946,56.41177109796798,56.41789009797618,56.42380709798402,56.42788909798953,56.4435630980104,56.45088709802018,56.45020509801927,56.44840809801688,56.44289609800953,56.44453209801173,56.45551109802636,56.45553534802639,56.46819759804325,56.46661209804117,56.47714409805517,56.47850609805702,56.48141309806088,56.48396509806426,56.48122909806063,56.47612509805381,56.47130709804735,56.46667309804126,56.46912509804452,56.47319209804995,56.48792809806954,56.49748009808226,56.50379009809067,56.51001909809894,56.51338009810348,56.52329409811667,56.531786098128,56.54353909814363,56.55233209815527,56.55680209816125,56.55538709815936,56.55602009816025,56.5589580981641,56.5654350981727,56.56491309817207,56.57185509818125,56.57914909819096,56.58070509819306,56.58275009819572,56.58385609819724,56.58469609819834,56.58811309820283,56.59058509820619,56.59672709821435,56.5998860982185,56.60209809822151,56.61881009824361,56.6246470982514,56.6314750982605,56.63473309826477,56.63365709826335,56.63642309826708,56.65666709829389,56.65777409829536,56.66548309830561,56.67266609831512,56.67298709831559,56.67645009832015,56.67503509831833,56.68044109832544,56.68263009832832,56.6938990983433,56.69666809834693,56.70296309835531,56.70502309835802,56.70567109835888,56.70434009835711,56.70920009836355,56.70444309835727,56.70214609835422,56.70310409835551,56.71299109836859,56.7192360983769,56.71966309837746,56.71640909837314,56.71776409837496,56.72028509837823,56.72186809838041,56.7196210983774,56.71932009837698,56.71432309837037,56.71452509837071,56.71970509837751,56.72448509838385,56.72628609838616,56.72691909838706,56.72357309838265,56.72511109838469,56.72257409838133,56.71620009837279,56.71213309836745,56.70655209836,56.70788009836181,56.71101909836595,56.72281809838163,56.73957609840382,56.75280909842137,56.75461009842368,56.75417909842319,56.76486709843729,56.76597809843874,56.76984209844387,56.77701009845338,56.77919909845622,56.7766050984528,56.77749409845404,56.78158309845942,56.78539409846443,56.78648209846594,56.78963609847004,56.79713609847995,56.80114509848531,56.81282609850074,56.83017909852359,56.83257809852682,56.83684709853247,56.84618509854485,56.84766509854678,56.85079009855085,56.85621409855806,56.86115009856456,56.86428209856867,56.86469409856922,56.88563309859686,56.89633009861098,56.90149909861778,56.90347109862042,56.90600009862381,56.91007409862912,56.91114209863058,56.91750509863898,56.92640809865067,56.9318250986578,56.93594509866325,56.9413930986704,56.94340309867308,56.94751909867858,56.94908709868056,56.95253509868508,56.95340509868626,56.9575400986917,56.96045109869555,56.96163309869711,56.96390709870009,56.9653030987019,56.96893509870667,56.9718760987106,56.98104309872263,56.98140909872306,56.99005709873452,56.99798009874495,57.00108109874902,57.00904209875952,57.0123960987639,57.02078809877497,57.02413009877934,57.02342809877845,57.02723109878347,57.03604709879503,57.03755009879699,57.04786509881054,57.05109609881479,57.05370509881821,57.05732109882301,57.06191809882908,57.0635930988312,57.06610709883448,57.06964709883916,57.07438809884541,57.0775960988496,57.08049909885342,57.08278109885638,57.09085609886704,57.09449909887181,57.10030509887943,57.10553909888628,57.10976209889186,57.11295509889599,57.11629609890045,57.12129009890696,57.12216309890814,57.12981609891815,57.13277609892204,57.13604109892631,57.13897109893014,57.13979909893127,57.14204609893417,57.14348009893611,57.14693209894057,57.14145409893342,57.14197709893411,57.14581809893917,57.14669209894029,57.14437309893723,57.14547909893869,57.15349409894918,57.16237809896085,57.17780809898107,57.17746109898062,57.17998309898388,57.17949509898326,57.1818900989864,57.20497309901664,57.20969909902281,57.23117209905091,57.26633609909691,57.29165009913001,57.30635209914927,57.31112509915545,57.31570209916137,57.31680809916282,57.32180209916939,57.32367109917183,57.33342109918445,57.33665209918877,57.33927309919216,57.34604409920102,57.35067509920708,57.35259809920954,57.35537909921318,57.35902209921798,57.36363409922399,57.3633360992236,57.35943409921845,57.35820209921692,57.35732409921574,57.35470409921233,57.35219709920906,57.3432060991973,57.32171409916921,57.31696509916305,57.31541609916105,57.313822099159,57.31489709916038,57.33107909918152,57.33433309918571,57.33864809919138,57.34823009920385,57.3513090992079,57.35434509921184,57.35360509921089,57.35558509921346,57.36097109922053,57.36336709922357,57.36813509922978,57.36862709923047,57.37723709924182,57.37585209923987,57.37760309924219,57.38123509924692,57.38430209925087,57.39301809926224,57.39408309926367,57.39821809926901,57.40775109928149,57.4136060992891,57.41757709929426,57.41359909928909,57.41781409929461,57.42347909930197,57.42523709930418,57.42794209930771,57.43078809931147,57.43992009932332,57.44228509932643,57.4461420993314,57.45122709933806,57.45305409934048,57.45603309934435,57.4646660993556,57.47212809936526,57.47318409936662,57.47476409936869,57.47945209937478,57.48450309938135,57.4845600993814,57.487333099385,57.49215509939131,57.49419209939391,57.49701909939759,57.50023409940182,57.50654009940997,57.50430109940712,57.50204209940416,57.50064609940232,57.50307209940549,57.50990509941435,57.50952709941384,57.51292209941828,57.52019709942774,57.52005509942759,57.52527009943427,57.53079809944149,57.53785509945067,57.54397009945858,57.54754409946322,57.56052209948007,57.56794109948973,57.57380994265752,57.60994782888262,57.61020109954454,57.61087185665205,58.39643295590368,58.3287101531028,55.47755684463978]},{"lng":[-1.821848969080238,-1.856474969112484,-1.855808969111863,-1.850679969107091,-1.84302396909996,-1.836040969093461,-1.823588969081868,-1.816299969075077,-1.806369969065829,-1.808292969067622,-1.805157969064694,-1.792197969052623,-1.781391969042559,-1.783965969044957,-1.782862969043933,-1.779900969041181,-1.781008969042205,-1.783410969044439,-1.789151969049783,-1.799521969059442,-1.803932969063553,-1.821848969080238],"lat":[55.6877380647883,55.68999306479135,55.68634206478639,55.68331706478227,55.68299606478184,55.68609406478605,55.68457206478402,55.68516306478483,55.6811690647794,55.67345206476887,55.67113306476572,55.67233406476738,55.67014506476441,55.67632506477279,55.6835990647827,55.68697506478726,55.68949306479064,55.68998106479135,55.68777606478831,55.69087006479253,55.69161006479354,55.6877380647883]},{"lng":[-2.56729297493888,-2.574631974945703,-2.570270974941651,-2.560985974933004,-2.554434974926893,-2.56729297493888],"lat":[56.1944900976772,56.1952230976782,56.18905009766988,56.18398109766312,56.18462209766398,56.1944900976772]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":2,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[55.5,1.4],5,[]],"limits":{"lat":[52.79041418572993,58.39643295590368],"lng":[-2.894352225243469,4.370524186553713]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="population-specification" class="level1">
<h1>Population specification</h1>
<p>Population is evenly distributed (density surface is horizontal) and the population size is apportioned to the strata according to the stratum size. This should result in both strata having the same density.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>areas <span class="ot">&lt;-</span> northsea<span class="sc">@</span>area</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>prop.south <span class="ot">&lt;-</span> areas[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(areas)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>prop.north <span class="ot">&lt;-</span> areas[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(areas)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>total.abundance <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>abund.south <span class="ot">&lt;-</span> <span class="fu">round</span>(total.abundance <span class="sc">*</span> prop.south)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>abund.north <span class="ot">&lt;-</span> <span class="fu">round</span>(total.abundance <span class="sc">*</span> prop.north)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>constant <span class="ot">&lt;-</span> <span class="fu">make.density</span>(<span class="at">region =</span> northsea, <span class="at">x.space =</span> <span class="dv">10</span>, <span class="at">constant =</span> <span class="dv">1</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>minkepop <span class="ot">&lt;-</span> <span class="fu">make.population.description</span>(<span class="at">region =</span> northsea,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">density =</span> constant,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">N =</span> <span class="fu">c</span>(abund.south, abund.north))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="survey-design" class="level1">
<h1>Survey design</h1>
<p>Specifying a single value for the number of samples will distribute the transects among strata proportional to the stratum sizes. Emphasis of this simulation study is <em>not</em> upon the properties of the survey design, therefore a simple systematic parallel line transect survey is created. Note however, there is large number of replicate transects in each stratum; a well-designed study. Any bias in the estimated densities cannot be attributed to poor design.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>coverage.grid <span class="ot">&lt;-</span> <span class="fu">make.coverage</span>(northsea, <span class="at">n.grid.points =</span> <span class="dv">100</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>equal.cover <span class="ot">&lt;-</span> <span class="fu">make.design</span>(<span class="at">region =</span> northsea,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">transect.type =</span> <span class="st">"line"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">design =</span> <span class="st">"systematic"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">samplers=</span><span class="dv">40</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">design.angle =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">40</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">truncation =</span> <span class="fl">0.8</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">coverage.grid =</span> coverage.grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="properties-of-the-design" class="level2">
<h2 class="anchored" data-anchor-id="properties-of-the-design">Properties of the design</h2>
<p>To demonstrate the estimated number of transects in each stratum, the <code>run.coverage</code> function is used to show the number of replicates in each stratum is allocated roughly according to stratum size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>design.properties <span class="ot">&lt;-</span> <span class="fu">run.coverage</span>(equal.cover, <span class="at">reps =</span> <span class="dv">10</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mine <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Num.transects=</span>design.properties<span class="sc">@</span>design.statistics<span class="sc">$</span>sampler.count[<span class="dv">3</span>,],</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Proportion.covered=</span>design.properties<span class="sc">@</span>design.statistics<span class="sc">$</span>p.cov.area[<span class="dv">3</span>,])</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Num.transects</th>
<th style="text-align: right;">Proportion.covered</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">South</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">8.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">North</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">8.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">8.15</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="what-analysis-to-conduct" class="level1">
<h1>What analysis to conduct</h1>
<p>For purposes of this investigation, we look only at the same key function under which the data were simulated (the half normal) with no covariates. In effect we are using the “wrong model” to make inference, except in the circumstance when <span class="math inline">\(\Delta = 1\)</span>.</p>
<p>A second analysis, <code>strat.specific.or.not</code> is constructed to assess model selection performance: the “wrong” model is paired with the “correct” model that assumes stratum-specific detectability. This contrast will measure the ability of AIC to choose the correct model as the difference between stratum-specific scale parameters (<span class="math inline">\(\Delta\)</span>) changes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pooled.hn <span class="ot">&lt;-</span> <span class="fu">make.ds.analysis</span>(<span class="at">dfmodel =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">key =</span> <span class="st">"hn"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">criteria =</span> <span class="st">"AIC"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">truncation =</span> <span class="fl">0.8</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>strat.specific.or.not <span class="ot">&lt;-</span> <span class="fu">make.ds.analysis</span>(<span class="at">dfmodel =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span>Region.Label),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">key =</span> <span class="st">"hn"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">criteria =</span> <span class="st">"AIC"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">truncation =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="heart-of-the-simulation" class="level1">
<h1>Heart of the simulation</h1>
<section id="loop-over-delta-difference-in-sigma-between-strata" class="level2">
<h2 class="anchored" data-anchor-id="loop-over-delta-difference-in-sigma-between-strata">Loop over <span class="math inline">\(\Delta\)</span> difference in <span class="math inline">\(\sigma\)</span> between strata</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>delta.multiplier <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.5</span>, <span class="at">to=</span><span class="fl">1.1</span>, <span class="at">by=</span><span class="fl">0.1</span>),</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                      seq(from=0.85, to=1.15, by=0.1),</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">seq</span>(<span class="at">from=</span><span class="fl">1.2</span>, <span class="at">to=</span><span class="fl">2.4</span>, <span class="at">by=</span><span class="fl">0.2</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>sigma.south <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>north.sigma <span class="ot">&lt;-</span> sigma.south<span class="sc">*</span>delta.multiplier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Scale parameter (<span class="math inline">\(\sigma\)</span>) for the southern stratum remains fixed at 0.3, but in the northern stratum, the scale parameter is a multiple of the southern stratum <span class="math inline">\(\sigma\)</span>, ranging from a low of 0.15 to a maximum of 0.72.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hn <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x) {<span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))}</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(north.sigma)) {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">hn</span>(north.sigma[i],x),<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="fl">0.8</span>,<span class="at">add=</span>i<span class="sc">!=</span><span class="dv">1</span>,  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Distance"</span>, <span class="at">ylab=</span><span class="st">"Detection probability"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Range of detection probability disparity</span><span class="sc">\n</span><span class="st">South function in blue"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">hn</span>(sigma.south,x),<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="fl">0.8</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stratumspecific-bias_files/figure-html/sigmarange-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>equalcover <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>whichmodel <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>num.sims <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(delta.multiplier)) {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  sigma.strata <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma.south, sigma.south<span class="sc">*</span>delta.multiplier[i])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  detect <span class="ot">&lt;-</span> <span class="fu">make.detectability</span>(<span class="at">key.function =</span> <span class="st">"hn"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">scale.param =</span> sigma.strata,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">truncation =</span> <span class="fl">0.8</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  equalcover.sim <span class="ot">&lt;-</span> <span class="fu">make.simulation</span>(<span class="at">reps =</span> num.sims,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">design =</span> equal.cover,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">population.description =</span> minkepop,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">detectability =</span> detect,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ds.analysis =</span> pooled.hn)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  whichmodel.sim <span class="ot">&lt;-</span> <span class="fu">make.simulation</span>(<span class="at">reps =</span> num.sims,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">design =</span> equal.cover,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">population.description =</span> minkepop,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">detectability =</span> detect,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ds.analysis =</span> strat.specific.or.not)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  equalcover[[i]] <span class="ot">&lt;-</span> <span class="fu">run.simulation</span>(equalcover.sim, <span class="at">run.parallel =</span> <span class="cn">TRUE</span>, <span class="at">max.cores=</span><span class="dv">7</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  whichmodel[[i]] <span class="ot">&lt;-</span> <span class="fu">run.simulation</span>(whichmodel.sim, <span class="at">run.parallel =</span> <span class="cn">TRUE</span>, <span class="at">max.cores=</span><span class="dv">7</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="simulation-findings" class="level1">
<h1>Simulation findings</h1>
<p>Tabular results of simulations iterating over the range of <span class="math inline">\(\Delta\)</span> values for the scale parameters of the two strata. As <span class="math inline">\(\Delta\)</span> approaches 1, the two detection functions converge, hence using the pooled detection function is appropriate. When <span class="math inline">\(\Delta&gt;1\)</span> bias again increases, however because for values of <span class="math inline">\(\Delta&gt;&gt;1\)</span>, the detection function for the North stratum becomes nearly horizontal. The number of detections in the North stratum is becoming asymptotic. There is little margin for bias to arise in the North density estimate; bulk of bias arises from estimates in the South stratum.</p>
<p>The final column of the table indicates the proportion of replicates for which the stratum-specific detection function is selected using AIC. The stratum-specific detection function model is the “correct” model when <span class="math inline">\(\Delta \neq 1\)</span>. However the stratum-specific detection function model is selected <span class="math inline">\(\approx\)</span> 20% of the time when <span class="math inline">\(\Delta \approx 1\)</span>. More troubling, the stratum-specific detection function model is selected &lt;50% of the time when <span class="math inline">\(\Delta \neq 1\)</span> implying the “incorrect” model using a pooled detection function is selected &gt;50% of the time, even for large values of <span class="math inline">\(\Delta\)</span>.</p>
<div class="{.cell='{}'}">
<div class="cell-output-display">
<table class="caption-top table">
<caption>Results using pooled detection function</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Bias.N</th>
<th style="text-align: right;">Bias.S</th>
<th style="text-align: right;">Bias.Tot</th>
<th style="text-align: right;">CICover.N</th>
<th style="text-align: right;">CICover.S</th>
<th style="text-align: right;">CICover.Tot</th>
<th style="text-align: right;">Detects.N</th>
<th style="text-align: right;">Detects.S</th>
<th style="text-align: right;">Detects.Tot</th>
<th style="text-align: right;">Prop.strat.model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right;">-35.1</td>
<td style="text-align: right;">27.9</td>
<td style="text-align: right;">-12.8</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.6</td>
<td style="text-align: right;">-19.4</td>
<td style="text-align: right;">29.3</td>
<td style="text-align: right;">-2.1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.7</td>
<td style="text-align: right;">-17.6</td>
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">-8.4</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.8</td>
<td style="text-align: right;">-15.4</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">-6.0</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">0.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">-1.9</td>
<td style="text-align: right;">21.2</td>
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.1</td>
<td style="text-align: right;">-1.8</td>
<td style="text-align: right;">-9.1</td>
<td style="text-align: right;">-4.4</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.2</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">-15.5</td>
<td style="text-align: right;">-4.3</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">0.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.4</td>
<td style="text-align: right;">13.5</td>
<td style="text-align: right;">-11.3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.6</td>
<td style="text-align: right;">8.5</td>
<td style="text-align: right;">-21.7</td>
<td style="text-align: right;">-2.2</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.8</td>
<td style="text-align: right;">17.1</td>
<td style="text-align: right;">-26.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">-35.6</td>
<td style="text-align: right;">-7.6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.2</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">-27.5</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">174</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.4</td>
<td style="text-align: right;">10.8</td>
<td style="text-align: right;">-35.9</td>
<td style="text-align: right;">-5.8</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When employing model selection to choose between models with pooled detection functions and stratum-specific detection functions, the most worrisome cases of bias arising when <span class="math inline">\(\Delta &lt;&lt; 1\)</span> are eliminated. Bias in stratum-specific density estimates become more pronounced as <span class="math inline">\(\Delta &gt;&gt; 1\)</span>.When <span class="math inline">\(\Delta\)</span> is at its maximum, the probability of using the model that produces unbiased stratum-specific estimates is 1</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Bias in density estimates when using model selected using AIC.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Bias.N</th>
<th style="text-align: right;">Bias.S</th>
<th style="text-align: right;">Bias.Tot</th>
<th style="text-align: right;">CICover.N</th>
<th style="text-align: right;">CICover.S</th>
<th style="text-align: right;">CICover.Tot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.7</td>
<td style="text-align: right;">-0.8</td>
<td style="text-align: right;">12.9</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.8</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">9.7</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">-4.2</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">-2.3</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">-6.3</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">-3.4</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.1</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">-7.7</td>
<td style="text-align: right;">-0.7</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.2</td>
<td style="text-align: right;">-0.7</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.4</td>
<td style="text-align: right;">-6.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: right;">-4.0</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.6</td>
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.8</td>
<td style="text-align: right;">-3.5</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">-0.6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">8.4</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.2</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.4</td>
<td style="text-align: right;">-2.8</td>
<td style="text-align: right;">-6.1</td>
<td style="text-align: right;">-4.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="conclusions-from-this-portion-of-study" class="level2">
<h2 class="anchored" data-anchor-id="conclusions-from-this-portion-of-study">Conclusions from this portion of study</h2>
<p>Note bias in the estimated density for the entire study area is never greater than 10%, yet another demonstration of <strong>pooling robustness.</strong> Even with widely differing detection functions, the estimated density ignoring stratum-specific differences is essentially unbiased.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stratumspecific-bias_files/figure-html/matplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stratumspecific-bias_files/figure-html/matplot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Confidence interval coverage for stratum-specific estimates approaches nominal levels when <span class="math inline">\(\Delta \approx 1\)</span>. Coverage for the density estimate in the entire study area is nominal for all values of <span class="math inline">\(\Delta\)</span> with the exception of <span class="math inline">\(\Delta&lt;0.7\)</span>.</p>
</section>
<section id="model-selection-sensitivity" class="level2">
<h2 class="anchored" data-anchor-id="model-selection-sensitivity">Model selection sensitivity</h2>
<p>This small simulation demonstrates the peril of making stratum-specific estimates when using a detection function that does not recognise stratum-specific detection function differences. This situation can arise when numbers of stratum-specific detections are too small to support stratum-specific detection functions. This set of simulations was devised such that there was sufficient effort in each stratum to avoid small numbers of detections. Even so, use of the “wrong” (pooled) detection function leads to considerable bias in density estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(delta.multiplier, modelsel, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Stratum-specific model chosen"</span>, <span class="at">type=</span><span class="st">"b"</span>, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(Delta), <span class="at">ylab=</span><span class="st">"Stratum covariate chosen"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="stratumspecific-bias_files/figure-html/modsel-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are two messages from this model selection assessment. Only when <span class="math inline">\(\Delta &lt; 0.8\)</span> or <span class="math inline">\(\Delta &gt; 1.2\)</span> is there a better than even chance AIC will detect the difference in detectability between strata. Values of <span class="math inline">\(\Delta\)</span> in this region do not lead to extreme bias in stratum-specific density estimates when the pooled detection function model is used. There is roughly a 10% negative bias in density estimates of the north stratum and a 5% positive bias in density estimates of the southern stratum.</p>
</section>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Buckland2015" class="csl-entry" role="listitem">
Buckland, S. T., Rexstad, E. A., Marques, T. A., &amp; Oedekoven, C. S. (2015). <em>Distance sampling: Methods and applications</em>. <span>Springer</span>.
</div>
</div></section></div></main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>