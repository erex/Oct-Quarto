<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Centre for Research into Ecological and Environmental Modelling   University of St Andrews">
<meta name="dcterms.date" content="2022-10-09">

<title>Distance sampling lab book - Demonstration two stages of model selection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Distance sampling lab book</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr1/sampling.html">Sampling</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr2/detnfns.html">Detn fns</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Pr3/criticism.html" aria-current="page">Criticism</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr4/precision.html">Precision</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Pr5/points.html">Points</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Demonstration two stages of model selection</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr3/criticism.html" class="sidebar-item-text sidebar-link">Model criticism practical 3</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr3/Pr3-instructions.html" class="sidebar-item-text sidebar-link">Assessing line transect detection functions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Pr3/modelsel-demo.html" class="sidebar-item-text sidebar-link active">Demonstration two stages of model selection</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link active" data-scroll-target="#data-preparation">Data preparation</a></li>
  <li><a href="#what-does-it-mean-to-include-adjustment-terms" id="toc-what-does-it-mean-to-include-adjustment-terms" class="nav-link" data-scroll-target="#what-does-it-mean-to-include-adjustment-terms">What does it mean to <em>include adjustment terms</em>?</a></li>
  <li><a href="#candidate-models" id="toc-candidate-models" class="nav-link" data-scroll-target="#candidate-models">Candidate models</a></li>
  <li><a href="#first-round-of-model-selection" id="toc-first-round-of-model-selection" class="nav-link" data-scroll-target="#first-round-of-model-selection">First round of model selection</a>
  <ul class="collapse">
  <li><a href="#half-normal-cosine" id="toc-half-normal-cosine" class="nav-link" data-scroll-target="#half-normal-cosine">Half-normal cosine</a></li>
  <li><a href="#uniform-cosine" id="toc-uniform-cosine" class="nav-link" data-scroll-target="#uniform-cosine">Uniform cosine</a></li>
  <li><a href="#hazard-rate-cosine" id="toc-hazard-rate-cosine" class="nav-link" data-scroll-target="#hazard-rate-cosine">Hazard rate cosine</a></li>
  </ul></li>
  <li><a href="#second-round-of-model-selection" id="toc-second-round-of-model-selection" class="nav-link" data-scroll-target="#second-round-of-model-selection">Second round of model selection</a></li>
  <li><a href="#bonus" id="toc-bonus" class="nav-link" data-scroll-target="#bonus">Bonus</a></li>
  <li><a href="#question-for-you" id="toc-question-for-you" class="nav-link" data-scroll-target="#question-for-you">Question for you</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Demonstration two stages of model selection</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Centre for Research into Ecological and Environmental Modelling <br> <strong>University of St Andrews</strong> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 9, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Demonstration
</div>
</div>
<div class="callout-body-container callout-body">
<p>Eastern tropical Pacific dolphin data</p>
</div>
</div>
<p>After my improvised description of selection of adjustment terms, I thought I should provide a more thorough description via an example. The purpose of the demonstration is to fit models with adjustments to a data set and expose, in detail, all models fitted during the process.</p>
<p>For this demonstration, I require a data set with an interesting shape to the histogram. I will not describe the data set, other than to note it contains roughly 1000 detections. We will see this data set again next week. More complete details of the data set, as well as a detailed analysis are in <span class="citation" data-cites="FMARBUC03">Marques &amp; Buckland (<a href="#ref-FMARBUC03" role="doc-biblioref">2003</a>)</span>.</p>
<section id="data-preparation" class="level1">
<h1>Data preparation</h1>
<p>I’m only going to use a portion of the detections, as the survey vessel used a combination of observers in various locations on the ship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Distance)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ETP_Dolphin"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>bino <span class="ot">&lt;-</span> <span class="fu">subset</span>(ETP_Dolphin, Search.method<span class="sc">&lt;</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-does-it-mean-to-include-adjustment-terms" class="level1">
<h1>What does it mean to <em>include adjustment terms</em>?</h1>
<p>When I submit the following code, I am actually requesting that a number of models with a half-normal key be fitted to data. I am leaving it to the <code>ds()</code> function to perform model selection among competing half-normal keys with 0, 1, 2, 3, 4 or 5 adjustment terms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>some.results <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>bino, <span class="at">key=</span><span class="st">"hn"</span>, <span class="at">adjustments=</span><span class="st">"cos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the model with a single adjustment term is preferable to the model without an adjustment term, then a model with two adjustment terms is fitted and its AIC is compared to the single term model’s AIC. This pattern repeats until the best half-normal with cosine adjustments model is identified in a stepwise fashion.</p>
</section>
<section id="candidate-models" class="level1">
<h1>Candidate models</h1>
<p>I wish to fit each of the key functions (uniform, half-normal and hazard rate). In addition, I also wish to include adjustment terms for each of the key functions. I limit my enthusiasm to consider only cosine adjustment terms. The actual number of models that will be fit to the data is unknown at this point.</p>
</section>
<section id="first-round-of-model-selection" class="level1">
<h1>First round of model selection</h1>
<p>The messages echoed to the console by <code>ds()</code> will show the <em>within key function</em> model selection progression.</p>
<section id="half-normal-cosine" class="level2">
<h2 class="anchored" data-anchor-id="half-normal-cosine">Half-normal cosine</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hncos <span class="ot">&lt;-</span> <span class="fu">ds</span>(bino, <span class="at">key=</span><span class="st">"hn"</span>, <span class="at">adj=</span><span class="st">"cos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2816.871</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function with cosine(2) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2805.973</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function with cosine(2,3) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2807.589</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Half-normal key function with cosine(2) adjustments selected.</code></pre>
</div>
</div>
<p>Three models with the half-normal key are fitted, with the preferred model being the second fitted, namely the model with a single adjustment term.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<p>
</p><pre class="mermaid" data-tooltip-selector="#mermaid-tooltip-1">%%{init: {'theme': 'forest' } }%%
graph TD
   D(ds_data, key='hn', adj='cos')
   D --&gt; ID0
   D --&gt; ID1
   D --&gt; ID2
   ID0(hn0<br>AIC=2817)
   ID1(hn1<br>AIC=2806)
   ID2(hn2<br>AIC=2808)
   FIN(hn1)
   ID0 --&gt; FIN
   ID1 --&gt; FIN
   ID2 --&gt; FIN
 
</pre>
<div id="mermaid-tooltip-1" class="mermaidTooltip">

</div>
<p></p>
</div>
</div>
</div>
</section>
<section id="uniform-cosine" class="level2">
<h2 class="anchored" data-anchor-id="uniform-cosine">Uniform cosine</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>unicos <span class="ot">&lt;-</span> <span class="fu">ds</span>(bino, <span class="at">key=</span><span class="st">"unif"</span>, <span class="at">adj=</span><span class="st">"cos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2971.022</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2811.177</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2808.378</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2,3) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2806.685</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2,3,4) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2808.105</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uniform key function with cosine(1,2,3) adjustments selected.</code></pre>
</div>
</div>
<p>The same pattern as with the half-normal key, with a small exception. Four models with the uniform key are fitted, with the preferred model being the third fitted, namely the model with a three adjustment term.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<p>
</p><pre class="mermaid" data-tooltip-selector="#mermaid-tooltip-2">%%{init: {'theme': 'forest' } }%%
graph TD
   D(ds_data, key='unif', adj='cos')
   D --&gt; ID1
   D --&gt; ID2
   D --&gt; ID3
   D --&gt; ID4
   ID1(unif1<br>AIC=2811)
   ID2(unif2<br>AIC=2808)
   ID3(unif3<br>AIC=2807)
   ID4(unif4<br>AIC=2808)
   FIN(unif3)
   ID1 --&gt; FIN
   ID2 --&gt; FIN
   ID3 --&gt; FIN
   ID4 --&gt; FIN

</pre>
<div id="mermaid-tooltip-2" class="mermaidTooltip">

</div>
<p></p>
</div>
</div>
</div>
</section>
<section id="hazard-rate-cosine" class="level2">
<h2 class="anchored" data-anchor-id="hazard-rate-cosine">Hazard rate cosine</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>hrcos <span class="ot">&lt;-</span> <span class="fu">ds</span>(bino, <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">adj=</span><span class="st">"cos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2805.467</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function with cosine(2) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 2807.47</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Hazard-rate key function selected.</code></pre>
</div>
</div>
<p>Two models are fitted with the hazard rate key function. The addition of a single adjustment term does not improve the AIC score, so there is no point in fitting a more complex model with additional adjustment terms.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<p>
</p><pre class="mermaid" data-tooltip-selector="#mermaid-tooltip-3">%%{init: {'theme': 'forest' } }%%
graph TD
   D(ds_data, key='hr', adj='cos')
   D --&gt; ID0
   D --&gt; ID1
   ID0(hr0<br>AIC=2805)
   ID1(hr1<br>AIC=2807)
   FIN(hr0)
   ID0 --&gt; FIN
   ID1 --&gt; FIN
</pre>
<div id="mermaid-tooltip-3" class="mermaidTooltip">

</div>
<p></p>
</div>
</div>
</div>
<p>The contestants that emerge from the first round of model competition are:</p>
<ul>
<li>half-normal with 1 adjustment term</li>
<li>uniform with 3 adjustment terms</li>
<li>hazard rate with no adjustment terms</li>
</ul>
</section>
</section>
<section id="second-round-of-model-selection" class="level1">
<h1>Second round of model selection</h1>
<p>While assessing relative measures of fit with AIC, I’ll also assess absolute goodness of fit. I’m not exposing the call to the function <code>summarize_ds_models()</code> that performs this.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Key function </th>
   <th style="text-align:right;"> C-vM $p$-value </th>
   <th style="text-align:right;"> Delta AIC </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Hazard-rate </td>
   <td style="text-align:right;"> 0.481 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Half-normal with cosine adjustment term of order 2 </td>
   <td style="text-align:right;"> 0.467 </td>
   <td style="text-align:right;"> 0.506 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Uniform with cosine adjustment terms of order 1,2,3 </td>
   <td style="text-align:right;"> 0.503 </td>
   <td style="text-align:right;"> 1.218 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<p>
</p><pre class="mermaid" data-tooltip-selector="#mermaid-tooltip-4">%%{init: {'theme': 'forest' } }%%
graph TD
   D(summarise_ds_models.hn1, unif3, hr0)
   D --&gt; hn1(hn1<br>AIC=2806)
   D --&gt; unif3(unif3<br>AIC=2806)
   D --&gt; hr0(hr0<br>AIC=2805)
   FIN(hr0)
   hn1 --&gt; FIN
   unif3 --&gt; FIN
   hr0 --&gt; FIN
</pre>
<div id="mermaid-tooltip-4" class="mermaidTooltip">

</div>
<p></p>
</div>
</div>
</div>
<p>All models adequately fit the data as shown by the Cramer von Mises P-values. It is a close contest between models for smallest AIC score, with the smallest (by a fraction) going to the hazard rate model.</p>
</section>
<section id="bonus" class="level1">
<h1>Bonus</h1>
<p>Should I be concerned that the hazard rate might be over-fitting that spike, is the spike an artefact in the data that is exerting undue influence upon my choice of model? If I have such concerns, I might choose to <strong>over-ride</strong> the model choice made by AIC.</p>
<div class="cell">
<div class="cell-output-display">

<table class="table table-condensed" style="width: auto !important; float: right; margin-left: 10px;">
 <thead>
  <tr>
   <th style="text-align:left;"> Key function </th>
   <th style="text-align:right;"> Average detectability </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Hazard-rate </td>
   <td style="text-align:right;"> 0.563 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Half-normal with cosine adjustment term of order 2 </td>
   <td style="text-align:right;"> 0.564 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Uniform with cosine adjustment terms of order 1,2,3 </td>
   <td style="text-align:right;"> 0.555 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>I am comforted by the robustness of the estimates of <span class="math inline">\(\hat{P_a}\)</span> to choice of key function. Hence, the decision of what model to use is of little consequence in the estimate of dolphin density.</p>
<p>Given the minute differences in <span class="math inline">\(\hat{P_a}\)</span> produced by each model, I have little reason to believe the shapes of the fitted detection functions will differ. Let’s look.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelsel-demo_files/figure-html/figure-1.png" class="img-fluid" style="width:33.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsel-demo_files/figure-html/figure-2.png" class="img-fluid" style="width:33.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsel-demo_files/figure-html/figure-3.png" class="img-fluid" style="width:33.0%"></p>
</div>
</div>
</section>
<section id="question-for-you" class="level1">
<h1>Question for you</h1>
<p>What would you expect the Q-Q plot to look like for any of these models with this data?</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand to see if you are correct
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<section id="goodness-of-fit-half-normal-cosine" class="level4 callout-body-container callout-body">
<h4 class="anchored" data-anchor-id="goodness-of-fit-half-normal-cosine">Goodness of fit, half normal cosine</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelsel-demo_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</div>
</div>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography">
<div id="ref-FMARBUC03" class="csl-entry" role="doc-biblioentry">
Marques, F. F. C., &amp; Buckland, S. T. (2003). Incorporating covariates into standard line transect analyses. <em>Biometrics</em>, <em>59</em>, 924–935. <a href="https://doi.org/10.1111/j.0006-341x.2003.00107.x">https://doi.org/10.1111/j.0006-341x.2003.00107.x</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>